{"version":"NotebookV1","origId":767643462327073,"name":"2_driver_standings","language":"python","commands":[{"version":"CommandV1","origId":538340300028318,"guid":"333f0b18-0505-4398-88ce-08e8da6608a3","subtype":"command","commandType":"auto","position":0.5,"command":"dbutils.widgets.text('p_file_date', '')\nv_file_date = dbutils.widgets.get('p_file_date')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{"p_file_date":"2021-04-18"},"addedWidgets":{"p_file_date":{"widgetType":"text","name":"p_file_date","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472178,"submitTime":1673226471935,"finishTime":1673226472278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a5407c5f-8865-4c31-abd0-a51b4e5a0da7"},{"version":"CommandV1","origId":538340300028319,"guid":"ed00cec1-9e46-406c-bb61-7dfc2baa2ecf","subtype":"command","commandType":"auto","position":1.5,"command":"%run \"../includes/common_functions\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472002,"submitTime":1673226472002,"finishTime":1673226473107,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"76276c63-386a-44a0-95f6-f288b461a049"},{"version":"CommandV1","origId":538340300028333,"guid":"6c1c2829-611e-4b5d-92bc-edaca17ab19c","subtype":"command","commandType":"auto","position":1.75,"command":"race_results_list = spark.sql(f\"SELECT DISTINCT race_year from f1_presentation.races_results where file_date = '{v_file_date}'\").collect()\n\n\n","commandVersion":80,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472986,"submitTime":1673226472064,"finishTime":1673226473584,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"198c2d37-0c33-4ef1-bc7b-9436e1794827"},{"version":"CommandV1","origId":538340300028334,"guid":"23aef6dc-aec3-47c7-835e-415138a718aa","subtype":"command","commandType":"auto","position":0.75,"command":"v_file_date","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Out[92]: '2021-04-18'","name":null,"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472283,"submitTime":1673226471986,"finishTime":1673226472379,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",21]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ea952fff-b52d-4cc3-92eb-2e8a4070a86e"},{"version":"CommandV1","origId":538340300028335,"guid":"1b0abbc5-c94f-4ad0-86db-55186f38752f","subtype":"command","commandType":"auto","position":1.875,"command":"from pyspark.sql.functions import col","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226473689,"submitTime":1673226472076,"finishTime":1673226473785,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9b5b780c-7301-41de-a4fc-29967b57875a"},{"version":"CommandV1","origId":538340300028336,"guid":"457463b0-3cd0-444d-9321-bc4290567144","subtype":"command","commandType":"auto","position":1.8125,"command":"race_year_list = []\n\nfor x in race_results_list:\n    race_year_list.append(x.race_year)\n\n","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226473596,"submitTime":1673226472071,"finishTime":1673226473684,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"787dacc9-075e-4ded-b04c-3bcbac3f31a5"},{"version":"CommandV1","origId":538340300028345,"guid":"344c81cf-65b4-4a08-bfc1-378b41f480e1","subtype":"command","commandType":"auto","position":16.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7e1af43b-0c49-4e8d-9610-29969fbbadb2"},{"version":"CommandV1","origId":767643462327074,"guid":"d32118b6-40a5-43fa-ad9c-a8104a7fcf56","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"../includes/configuration\"","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226471992,"submitTime":1673226471992,"finishTime":1673226472749,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"21e91569-3dda-4ad0-b140-12ef96e68ccc"},{"version":"CommandV1","origId":767643462327076,"guid":"6a0194d9-1de8-4a33-b03d-11e3b1762a78","subtype":"command","commandType":"auto","position":2.0,"command":"df = spark.read.format('delta').load(f'{presentation_folder_path}/races_results').filter(col('race_year').isin(race_year_list))\n","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_id","nullable":true,"type":"integer"},{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"race_name","nullable":true,"type":"string"},{"metadata":{},"name":"race_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"circuit_location","nullable":true,"type":"string"},{"metadata":{},"name":"driver_name","nullable":true,"type":"string"},{"metadata":{},"name":"driver_number","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_nationality","nullable":true,"type":"string"},{"metadata":{},"name":"team","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap","nullable":true,"type":"integer"},{"metadata":{},"name":"race_time","nullable":true,"type":"string"},{"metadata":{},"name":"points","nullable":true,"type":"float"},{"metadata":{},"name":"position","nullable":true,"type":"integer"},{"metadata":{},"name":"file_date","nullable":true,"type":"string"},{"metadata":{},"name":"created_dame","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226473789,"submitTime":1673226472082,"finishTime":1673226473885,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d6f515e1-feb4-4a5a-8293-1817ac1015e1"},{"version":"CommandV1","origId":767643462327078,"guid":"89d40402-4b4c-4b14-8f2d-9ce36aaeb1bd","subtype":"command","commandType":"auto","position":3.5,"command":"from pyspark.sql.functions import countDistinct, count, avg, sum ,when, col\n","commandVersion":31,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226473890,"submitTime":1673226472087,"finishTime":1673226473986,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e4024aef-dc55-4477-b141-439d58380aef"},{"version":"CommandV1","origId":767643462327084,"guid":"1a677f41-c442-42ef-a2d9-a6dd389f7737","subtype":"command","commandType":"auto","position":9.0,"command":"groupedW = df.groupBy('race_year','driver_name', 'driver_nationality').agg(sum('points').alias('total_points'), count( when(df.position == 1, True)).alias('wins') ) \n\n\n","commandVersion":134,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"groupedW","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_name","nullable":true,"type":"string"},{"metadata":{},"name":"driver_nationality","nullable":true,"type":"string"},{"metadata":{},"name":"total_points","nullable":true,"type":"double"},{"metadata":{},"name":"wins","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226473990,"submitTime":1673226472092,"finishTime":1673226474086,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2fa53510-7e4c-430f-8ba3-052f4b6037bf"},{"version":"CommandV1","origId":767643462327085,"guid":"3185a07b-fe82-4193-ac9a-4ef60af96a26","subtype":"command","commandType":"auto","position":10.0,"command":"from pyspark.sql.window import Window\nfrom pyspark.sql.functions import desc, rank","commandVersion":26,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226474091,"submitTime":1673226472098,"finishTime":1673226474186,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2f4084b5-1df3-4f73-94d3-d148ce984755"},{"version":"CommandV1","origId":767643462327086,"guid":"98f1f52c-dc64-4b8b-8b89-f6fb88099f78","subtype":"command","commandType":"auto","position":11.0,"command":"driverRank = Window.partitionBy('race_year').orderBy(desc('total_points'), desc('wins'))","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226474190,"submitTime":1673226472103,"finishTime":1673226474287,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ac2a78d3-adba-41e3-bd5f-308f242cfc85"},{"version":"CommandV1","origId":767643462327087,"guid":"fc0c4496-de33-48e6-983b-9976e8d9cfdf","subtype":"command","commandType":"auto","position":12.0,"command":"df_ranked = groupedW.withColumn('rank', rank().over(driverRank))","commandVersion":32,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_ranked","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_name","nullable":true,"type":"string"},{"metadata":{},"name":"driver_nationality","nullable":true,"type":"string"},{"metadata":{},"name":"total_points","nullable":true,"type":"double"},{"metadata":{},"name":"wins","nullable":false,"type":"long"},{"metadata":{},"name":"rank","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226474291,"submitTime":1673226472108,"finishTime":1673226474387,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5618532e-b365-4179-8f01-1b1a053dada8"},{"version":"CommandV1","origId":767643462327089,"guid":"048f5f3b-0d41-4648-875d-62bbfafeb30b","subtype":"command","commandType":"auto","position":14.0,"command":"\nmerge_condition = 'a.driver_name = b.driver_name and a.race_year = b.race_year'\nmerge_delta_data(df_ranked, 'f1_presentation', 'driver_standings', presentation_folder_path, merge_condition, 'race_year')","commandVersion":52,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226474392,"submitTime":1673226472113,"finishTime":1673226478398,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8af9b973-5eab-4711-9866-76775172278b"},{"version":"CommandV1","origId":767643462327092,"guid":"bd065abb-7b94-467c-9e75-ec7065d7b3ad","subtype":"command","commandType":"auto","position":15.0,"command":"\n%sql\n\nselect race_year, count(1)\nfrom f1_presentation.driver_standings\ngroup by race_year\norder by race_year desc","commandVersion":38,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[2021,20],[2020,23],[2019,20],[2018,20],[2017,25],[2016,24],[2015,22],[2014,24],[2013,23],[2012,25],[2011,28],[2010,27],[2009,25],[2008,22],[2007,26],[2006,27],[2005,27],[2004,25],[2003,24],[2002,23],[2001,26],[2000,23],[1999,24],[1998,23],[1997,28],[1996,24],[1995,35],[1994,46],[1993,35],[1992,37],[1991,41],[1990,40],[1989,47],[1988,36],[1987,32],[1986,32],[1985,36],[1984,35],[1983,35],[1982,40],[1981,39],[1980,41],[1979,36],[1978,46],[1977,61],[1976,54],[1975,52],[1974,62],[1973,43],[1972,42],[1971,50],[1970,43],[1969,31],[1968,43],[1967,45],[1966,33],[1965,54],[1964,41],[1963,62],[1962,61],[1961,62],[1960,91],[1959,88],[1958,87],[1957,76],[1956,85],[1955,84],[1954,97],[1953,108],[1952,105],[1951,84],[1950,81]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"race_year","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{\"__autoGeneratedAlias\":\"true\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{"__autoGeneratedAlias":"true"},"name":"count(1)","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226525622,"submitTime":1673226525598,"finishTime":1673226526155,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",72]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"19959e77-7689-46d3-ac1b-263b071cf5f4"},{"version":"CommandV1","origId":3029141207068845,"guid":"8104ea31-db2b-4b69-a5a4-860e7871b211","subtype":"script","commandType":"auto","position":1.5,"command":"","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472383,"submitTime":0,"finishTime":1673226472479,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["d32118b6-40a5-43fa-ad9c-a8104a7fcf56"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"841854ce-abf8-4e14-b0b4-472ed90b4801"},{"version":"CommandV1","origId":3029141207068846,"guid":"3dac01b3-96ab-4056-951d-22cdd2f109e7","subtype":"script","commandType":"auto","position":1.6666666666666667,"command":"","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472484,"submitTime":0,"finishTime":1673226472580,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ed00cec1-9e46-406c-bb61-7dfc2baa2ecf"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3ddce3dc-fd04-43d8-a956-fc796ef9b079"},{"version":"CommandV1","origId":3029141207068847,"guid":"c6fa1fc9-3427-4eeb-bd5e-a591567dff86","subtype":"script","commandType":"auto","position":1.8333333333333333,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472584,"submitTime":0,"finishTime":1673226472680,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ed00cec1-9e46-406c-bb61-7dfc2baa2ecf"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"226793fc-fd55-42cf-beb8-075cbc26e311"},{"version":"CommandV1","origId":3029141207068848,"guid":"afc44f6c-8583-496b-a3cb-87c8382e8696","subtype":"script","commandType":"auto","position":2.0,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472684,"submitTime":0,"finishTime":1673226472780,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ed00cec1-9e46-406c-bb61-7dfc2baa2ecf"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b4f8851c-cac2-4e36-9d73-dff1ca6844e4"},{"version":"CommandV1","origId":3029141207068849,"guid":"cef95a0a-4f45-441d-8a8b-89aeab18f95f","subtype":"script","commandType":"auto","position":2.1666666666666665,"command":"","commandVersion":113,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472784,"submitTime":0,"finishTime":1673226472881,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ed00cec1-9e46-406c-bb61-7dfc2baa2ecf"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72b673ba-24e9-48fc-9810-5af243c6dc07"},{"version":"CommandV1","origId":3029141207068850,"guid":"700f954a-cd3f-4647-802a-12e0e6462b8d","subtype":"script","commandType":"auto","position":2.3333333333333335,"command":"","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226472885,"submitTime":0,"finishTime":1673226472982,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ed00cec1-9e46-406c-bb61-7dfc2baa2ecf"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d310cced-5431-45b3-8b29-0bfade2e1e15"}],"dashboards":[],"guid":"7999d97b-22ac-44a7-8068-c53b64dc3058","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"p_file_date":{"nuid":"dedc7dca-eacf-4c95-a4ed-129de3957e6b","currentValue":"2021-04-18","widgetInfo":{"widgetType":"text","name":"p_file_date","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}},"typedWidgetInfo":null}},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":767643462327092,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE","environmentMetadata":null}