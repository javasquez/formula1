{"version":"NotebookV1","origId":767643462327093,"name":"3_constructor_standings","language":"python","commands":[{"version":"CommandV1","origId":538340300028366,"guid":"5432ccfa-dd18-4bcd-b908-6352a3a08a8e","subtype":"command","commandType":"auto","position":0.5,"command":"dbutils.widgets.text('p_file_date', '')\nv_file_date = dbutils.widgets.get('p_file_date')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{"p_file_date":"2021-04-18"},"addedWidgets":{"p_file_date":{"widgetType":"text","name":"p_file_date","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727282,"submitTime":1673226727152,"finishTime":1673226727321,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"68843bff-51ba-4327-9a0a-c47eb0b65cc5"},{"version":"CommandV1","origId":538340300028367,"guid":"7488dad6-f705-49e0-bcb2-f677178186cd","subtype":"command","commandType":"auto","position":1.5,"command":"%run \"../includes/common_functions\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727165,"submitTime":1673226727165,"finishTime":1673226728182,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"db21902f-075c-42e2-b657-d86c7aa58a4a"},{"version":"CommandV1","origId":538340300028371,"guid":"d5bc5345-456e-4ae6-bf1d-b5a770195330","subtype":"command","commandType":"auto","position":2.75,"command":"race_year_list = df_column_to_list(results_df, 'race_year')\n","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728029,"submitTime":1673226727187,"finishTime":1673226728326,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4dd9a73e-3e4c-4687-a51e-a65afc31b843"},{"version":"CommandV1","origId":538340300028377,"guid":"9921ad37-3353-47df-8a32-d91526e8ce0c","subtype":"command","commandType":"auto","position":6.25,"command":"\ndf = spark.read.format('delta').load(f'{presentation_folder_path}/races_results').filter(col('race_year').isin(race_year_list))\n","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_id","nullable":true,"type":"integer"},{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"race_name","nullable":true,"type":"string"},{"metadata":{},"name":"race_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"circuit_location","nullable":true,"type":"string"},{"metadata":{},"name":"driver_name","nullable":true,"type":"string"},{"metadata":{},"name":"driver_number","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_nationality","nullable":true,"type":"string"},{"metadata":{},"name":"team","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap","nullable":true,"type":"integer"},{"metadata":{},"name":"race_time","nullable":true,"type":"string"},{"metadata":{},"name":"points","nullable":true,"type":"float"},{"metadata":{},"name":"position","nullable":true,"type":"integer"},{"metadata":{},"name":"file_date","nullable":true,"type":"string"},{"metadata":{},"name":"created_dame","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728430,"submitTime":1673226727197,"finishTime":1673226728527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b8aa5e34-a65b-46aa-b16f-555732b481d8"},{"version":"CommandV1","origId":767643462327094,"guid":"bfd27edd-a679-4201-8ea8-63ab9722e82d","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"../includes/configuration\"","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727158,"submitTime":1673226727158,"finishTime":1673226727827,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"21e91569-3dda-4ad0-b140-12ef96e68ccc"},{"version":"CommandV1","origId":767643462327096,"guid":"97638154-0367-4276-b8ef-f26938114eb0","subtype":"command","commandType":"auto","position":2.0,"command":"\nresults_df = spark.read.format('delta').load(f'{presentation_folder_path}/races_results').filter(f\"file_date = '{v_file_date}'\") \n","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"results_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_id","nullable":true,"type":"integer"},{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"race_name","nullable":true,"type":"string"},{"metadata":{},"name":"race_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"circuit_location","nullable":true,"type":"string"},{"metadata":{},"name":"driver_name","nullable":true,"type":"string"},{"metadata":{},"name":"driver_number","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_nationality","nullable":true,"type":"string"},{"metadata":{},"name":"team","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap","nullable":true,"type":"integer"},{"metadata":{},"name":"race_time","nullable":true,"type":"string"},{"metadata":{},"name":"points","nullable":true,"type":"float"},{"metadata":{},"name":"position","nullable":true,"type":"integer"},{"metadata":{},"name":"file_date","nullable":true,"type":"string"},{"metadata":{},"name":"created_dame","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727928,"submitTime":1673226727182,"finishTime":1673226728025,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d6f515e1-feb4-4a5a-8293-1817ac1015e1"},{"version":"CommandV1","origId":767643462327097,"guid":"0c9dc384-c769-4441-bcd7-d57fc9cd3517","subtype":"command","commandType":"auto","position":3.5,"command":"from pyspark.sql.functions import countDistinct, count, avg, sum ,when, col\n","commandVersion":31,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728331,"submitTime":1673226727192,"finishTime":1673226728426,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e4024aef-dc55-4477-b141-439d58380aef"},{"version":"CommandV1","origId":767643462327098,"guid":"bb984358-ba76-4c16-b809-9260180f7b1e","subtype":"command","commandType":"auto","position":9.0,"command":"groupedW = df.groupBy('race_year','team').agg(sum('points').alias('total_points'), count( when(df.position == 1, True)).alias('wins') ) \n\n\n","commandVersion":137,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"groupedW","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"team","nullable":true,"type":"string"},{"metadata":{},"name":"total_points","nullable":true,"type":"double"},{"metadata":{},"name":"wins","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728531,"submitTime":1673226727203,"finishTime":1673226728627,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2fa53510-7e4c-430f-8ba3-052f4b6037bf"},{"version":"CommandV1","origId":767643462327100,"guid":"682dcd27-73a2-47f2-ac3f-70390a35db9c","subtype":"command","commandType":"auto","position":10.0,"command":"from pyspark.sql.window import Window\nfrom pyspark.sql.functions import desc, rank","commandVersion":26,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728631,"submitTime":1673226727207,"finishTime":1673226728728,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2f4084b5-1df3-4f73-94d3-d148ce984755"},{"version":"CommandV1","origId":767643462327101,"guid":"8fbd2d64-4cfe-4c31-95b1-490ab3c69904","subtype":"command","commandType":"auto","position":11.0,"command":"driverRank = Window.partitionBy('race_year').orderBy(desc('total_points'), desc('wins'))","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728732,"submitTime":1673226727212,"finishTime":1673226728828,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ac2a78d3-adba-41e3-bd5f-308f242cfc85"},{"version":"CommandV1","origId":767643462327102,"guid":"e8367edb-a0f8-4fe2-b91a-0fb306c88d96","subtype":"command","commandType":"auto","position":12.0,"command":"df_ranked = groupedW.withColumn('rank', rank().over(driverRank))","commandVersion":32,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_ranked","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"team","nullable":true,"type":"string"},{"metadata":{},"name":"total_points","nullable":true,"type":"double"},{"metadata":{},"name":"wins","nullable":false,"type":"long"},{"metadata":{},"name":"rank","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728832,"submitTime":1673226727218,"finishTime":1673226728929,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5618532e-b365-4179-8f01-1b1a053dada8"},{"version":"CommandV1","origId":767643462327104,"guid":"41cc5181-2935-4fe8-b0e4-cc7c2b1cecc3","subtype":"command","commandType":"auto","position":14.0,"command":"\nmerge_condition = 'a.team = b.team and a.race_year = b.race_year'\nmerge_delta_data(df_ranked, 'f1_presentation', 'constructor_standings', presentation_folder_path, merge_condition, 'race_year')","commandVersion":42,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226728934,"submitTime":1673226727223,"finishTime":1673226732135,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8af9b973-5eab-4711-9866-76775172278b"},{"version":"CommandV1","origId":767643462327105,"guid":"8772da23-a1c5-406f-b2b5-960daae6a962","subtype":"command","commandType":"auto","position":15.0,"command":"%sql\n\nselect race_year, count(1)\nfrom f1_presentation.constructor_standings\ngroup by race_year\norder by race_year desc","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[2021,10],[2020,10],[2019,10],[2018,10],[2017,10],[2016,11],[2015,10],[2014,11],[2013,11],[2012,12],[2011,12],[2010,12],[2009,10],[2008,11],[2007,11],[2006,12],[2005,10],[2004,10],[2003,10],[2002,11],[2001,11],[2000,11],[1999,11],[1998,11],[1997,12],[1996,11],[1995,13],[1994,14],[1993,13],[1992,16],[1991,19],[1990,19],[1989,20],[1988,18],[1987,16],[1986,14],[1985,17],[1984,15],[1983,16],[1982,17],[1981,17],[1980,15],[1979,19],[1978,19],[1977,21],[1976,21],[1975,20],[1974,20],[1973,12],[1972,12],[1971,12],[1970,12],[1969,11],[1968,17],[1967,20],[1966,15],[1965,16],[1964,13],[1963,22],[1962,19],[1961,14],[1960,23],[1959,26],[1958,16],[1957,14],[1956,15],[1955,19],[1954,19],[1953,21],[1952,25],[1951,24],[1950,24]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"race_year","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{\"__autoGeneratedAlias\":\"true\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{"__autoGeneratedAlias":"true"},"name":"count(1)","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226732141,"submitTime":1673226727228,"finishTime":1673226733235,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",72]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"19959e77-7689-46d3-ac1b-263b071cf5f4"},{"version":"CommandV1","origId":3029141207068857,"guid":"a4100d7a-884d-4893-971f-63d51cd1fd1f","subtype":"command","commandType":"auto","position":16.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fd1fd49e-7255-4f6e-a265-1267b8f55a3b"},{"version":"CommandV1","origId":3029141207068876,"guid":"4794f320-8b8b-43c9-aec9-db1ca8e63668","subtype":"script","commandType":"auto","position":1.5,"command":"","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727326,"submitTime":0,"finishTime":1673226727422,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["bfd27edd-a679-4201-8ea8-63ab9722e82d"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"841854ce-abf8-4e14-b0b4-472ed90b4801"},{"version":"CommandV1","origId":3029141207068877,"guid":"ca67ea77-e67f-420b-90ca-a9b19b9cf479","subtype":"script","commandType":"auto","position":1.6666666666666667,"command":"","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727426,"submitTime":0,"finishTime":1673226727522,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7488dad6-f705-49e0-bcb2-f677178186cd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3ddce3dc-fd04-43d8-a956-fc796ef9b079"},{"version":"CommandV1","origId":3029141207068878,"guid":"fe95c401-451e-4484-a9d2-bf9435f38a69","subtype":"script","commandType":"auto","position":1.8333333333333333,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727527,"submitTime":0,"finishTime":1673226727623,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7488dad6-f705-49e0-bcb2-f677178186cd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"226793fc-fd55-42cf-beb8-075cbc26e311"},{"version":"CommandV1","origId":3029141207068879,"guid":"f1ed0a41-2167-421e-abef-6d054c4d6ca1","subtype":"script","commandType":"auto","position":2.0,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727627,"submitTime":0,"finishTime":1673226727723,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7488dad6-f705-49e0-bcb2-f677178186cd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b4f8851c-cac2-4e36-9d73-dff1ca6844e4"},{"version":"CommandV1","origId":3029141207068880,"guid":"791f2ff7-a858-43d8-8c06-4e3133d40ad8","subtype":"script","commandType":"auto","position":2.1666666666666665,"command":"","commandVersion":113,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727727,"submitTime":0,"finishTime":1673226727824,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7488dad6-f705-49e0-bcb2-f677178186cd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72b673ba-24e9-48fc-9810-5af243c6dc07"},{"version":"CommandV1","origId":3029141207068881,"guid":"046ffacb-faea-4af8-9173-7af37edd0054","subtype":"script","commandType":"auto","position":2.3333333333333335,"command":"","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226727828,"submitTime":0,"finishTime":1673226727925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7488dad6-f705-49e0-bcb2-f677178186cd"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d310cced-5431-45b3-8b29-0bfade2e1e15"},{"version":"CommandV1","origId":3029141207068882,"guid":"58072fe8-80fd-4623-ad66-a1d87ed2c064","subtype":"command","commandType":"auto","position":14.5,"command":"%sql\n\nselect *\nfrom f1_presentation.constructor_standings\nwhere race_year = 2021","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[2021,"Mercedes",60.0,1,1],[2021,"Red Bull",53.0,1,2],[2021,"McLaren",41.0,0,3],[2021,"Ferrari",34.0,0,4],[2021,"AlphaTauri",8.0,0,5],[2021,"Aston Martin",5.0,0,6],[2021,"Alpine F1 Team",3.0,0,7],[2021,"Alfa Romeo",0.0,0,8],[2021,"Williams",0.0,0,8],[2021,"Haas F1 Team",0.0,0,8]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"race_year","type":"\"integer\"","metadata":"{}"},{"name":"team","type":"\"string\"","metadata":"{}"},{"name":"total_points","type":"\"double\"","metadata":"{}"},{"name":"wins","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_year","nullable":true,"type":"integer"},{"metadata":{},"name":"team","nullable":true,"type":"string"},{"metadata":{},"name":"total_points","nullable":true,"type":"double"},{"metadata":{},"name":"wins","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673226768387,"submitTime":1673226768099,"finishTime":1673226768770,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bbf5c0ea-f57b-45fa-bf79-edf7df5a798a"}],"dashboards":[],"guid":"e55a9997-23f9-4f78-8ca0-c38e02b4912f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"p_file_date":{"nuid":"b1d5bdaf-1313-4155-960e-32013c5008bc","currentValue":"2021-04-18","widgetInfo":{"widgetType":"text","name":"p_file_date","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}},"typedWidgetInfo":null}},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":3029141207068882,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE","environmentMetadata":null}