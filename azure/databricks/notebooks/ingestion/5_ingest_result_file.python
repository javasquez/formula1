{"version":"NotebookV1","origId":4309478197827952,"name":"5_ingest_result_file","language":"python","commands":[{"version":"CommandV1","origId":12687888541972,"guid":"5e4f02a0-9051-4a26-a439-e689b87b919e","subtype":"command","commandType":"auto","position":1.25,"command":"%run \"../includes/configuration\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"html","error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225315183,"submitTime":1673225315183,"finishTime":1673225316626,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7ccbe951-6608-4d02-b3f0-930b36bb3282"},{"version":"CommandV1","origId":12687888541979,"guid":"324e012e-fd67-4b83-bad6-e94bf5773317","subtype":"command","commandType":"auto","position":1.625,"command":"%run \"../includes/common_functions\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"The execution of this command did not finish successfully","errorTraceType":"ansi","error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225315210,"submitTime":1673225315210,"finishTime":1673225317295,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ff060e61-3185-4a8f-a1a9-3cf7787c7c8d"},{"version":"CommandV1","origId":296404507370945,"guid":"764eccfb-1f46-4bff-9374-9f37c02ac0a2","subtype":"command","commandType":"auto","position":1.0625,"command":"dbutils.widgets.text('p_file_date', '')\nv_file_date = dbutils.widgets.get('p_file_date')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{"p_file_date":"2021-04-18"},"addedWidgets":{"p_file_date":{"widgetType":"text","name":"p_file_date","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316320,"submitTime":1673225315178,"finishTime":1673225316412,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7f10bbd4-0c7a-40c4-b732-5eea7e846ea2"},{"version":"CommandV1","origId":296404507370948,"guid":"b4a022bd-b2d6-437a-b572-e8048d23bea4","subtype":"command","commandType":"auto","position":14.0,"command":"%sql \n\nselect distinct file_date from f1_processed.results","commandVersion":7,"state":"finished","results":{"type":"raw","data":"Command skipped","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225336371,"submitTime":1673225315288,"finishTime":1673225336371,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["raw",15]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ca2a23bd-81f6-40f1-8002-b03ae06ac1ad"},{"version":"CommandV1","origId":296404507370952,"guid":"653a7c14-ca0c-4f0c-ac76-b79531de19c9","subtype":"command","commandType":"auto","position":9.0,"command":"\n#for x in df_results_transformed.select('race_id').distinct().collect():\n#    if (spark._jsparkSession.catalog().tableExists('f1_processed.results')):\n#        spark.sql(f\"ALTER TABLE f1_processed.results DROP IF EXISTS PARTITION (race_id =  {x.race_id})\")","commandVersion":110,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225318031,"submitTime":1673225315263,"finishTime":1673225318120,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"970b1028-5964-4ac5-8796-f6971628853f"},{"version":"CommandV1","origId":296404507370972,"guid":"cf157b71-1639-40c1-804d-fb95da542326","subtype":"command","commandType":"auto","position":16.0,"command":"","commandVersion":13,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f60e1db8-dc9d-44e1-9af0-09aa291e1fab"},{"version":"CommandV1","origId":296404507370984,"guid":"4fd68e75-9986-41f1-b943-e76639a83f6b","subtype":"command","commandType":"auto","position":9.875,"command":"merge_condition = 'a.result_id = b.result_id and a.race_id = b.race_id'\nmerge_delta_data(df_results_reduped, 'f1_processed', 'results', processed_folder_path, merge_condition, 'race_id')","commandVersion":75,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225318130,"submitTime":1673225315268,"finishTime":1673225336271,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"351d6d82-08f8-4329-ac56-aecba651ab1b"},{"version":"CommandV1","origId":296404507370989,"guid":"8d3eba2d-5eb3-422f-9a73-21997a49fd39","subtype":"command","commandType":"auto","position":0.6875,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"27c5c555-977c-478b-b975-0040fd8719c3"},{"version":"CommandV1","origId":3029141207068686,"guid":"51bfb94a-c409-44a2-b3a9-0a564a673db0","subtype":"command","commandType":"auto","position":17.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"debc87f7-5e1f-4a08-8109-d3a6e060560f"},{"version":"CommandV1","origId":3029141207068784,"guid":"8d5277d8-db70-4ac8-b0b7-fffa4aec7a1d","subtype":"command","commandType":"auto","position":13.5,"command":"","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c5cd9563-8b0b-446a-83be-8b7eb2042853"},{"version":"CommandV1","origId":3029141207068797,"guid":"29e1fadf-6e13-4553-a4a5-6a81438996b8","subtype":"script","commandType":"auto","position":1.75,"command":"","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316421,"submitTime":0,"finishTime":1673225316513,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["5e4f02a0-9051-4a26-a439-e689b87b919e"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"841854ce-abf8-4e14-b0b4-472ed90b4801"},{"version":"CommandV1","origId":3029141207068798,"guid":"86c910b9-1d2c-4fca-a23d-37c7ab1d1a99","subtype":"script","commandType":"auto","position":1.7916666666666667,"command":"","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316522,"submitTime":0,"finishTime":1673225316613,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["324e012e-fd67-4b83-bad6-e94bf5773317"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3ddce3dc-fd04-43d8-a956-fc796ef9b079"},{"version":"CommandV1","origId":3029141207068799,"guid":"9b898587-e78b-41af-9771-2422628a69e6","subtype":"script","commandType":"auto","position":1.9583333333333333,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316622,"submitTime":0,"finishTime":1673225316714,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["324e012e-fd67-4b83-bad6-e94bf5773317"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"226793fc-fd55-42cf-beb8-075cbc26e311"},{"version":"CommandV1","origId":3029141207068800,"guid":"1be5e9c8-0728-44fa-a977-18f75d3f9ad8","subtype":"script","commandType":"auto","position":2.125,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316723,"submitTime":0,"finishTime":1673225316814,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["324e012e-fd67-4b83-bad6-e94bf5773317"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b4f8851c-cac2-4e36-9d73-dff1ca6844e4"},{"version":"CommandV1","origId":3029141207068801,"guid":"5a1f4f7a-1268-4715-9e8a-a04a5d6ce43c","subtype":"script","commandType":"auto","position":2.2916666666666665,"command":"","commandVersion":113,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316822,"submitTime":0,"finishTime":1673225316915,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["324e012e-fd67-4b83-bad6-e94bf5773317"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72b673ba-24e9-48fc-9810-5af243c6dc07"},{"version":"CommandV1","origId":3029141207068802,"guid":"6134ab50-6d19-4a0b-8139-f7e624565443","subtype":"script","commandType":"auto","position":2.4583333333333335,"command":"","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316923,"submitTime":0,"finishTime":1673225317015,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["324e012e-fd67-4b83-bad6-e94bf5773317"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d310cced-5431-45b3-8b29-0bfade2e1e15"},{"version":"CommandV1","origId":4190428027509663,"guid":"9b5fd696-8cf9-4496-9076-1d79438f9041","subtype":"command","commandType":"auto","position":0.875,"command":"dbutils.widgets.text('p_data_source', '')\nv_data_source = dbutils.widgets.get('p_data_source')\n","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{"p_data_source":"testing"},"addedWidgets":{"p_data_source":{"widgetType":"text","name":"p_data_source","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225316278,"submitTime":1673225315173,"finishTime":1673225316311,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7afd391c-de37-4503-8ac2-a10684e6f5a9"},{"version":"CommandV1","origId":4309478197827953,"guid":"b7e23f4b-c422-4011-8ec9-7703f4e463a3","subtype":"command","commandType":"auto","position":0.5,"command":"  %fs\nls /mnt/formula1dljavi/raw/\n","commandVersion":42,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/formula1dljavi/raw/2021-03-21/","2021-03-21/",0,1673110566000],["dbfs:/mnt/formula1dljavi/raw/2021-03-28/","2021-03-28/",0,1673110566000],["dbfs:/mnt/formula1dljavi/raw/2021-04-18/","2021-04-18/",0,1673110566000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"},{"name":"modificationTime","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225315367,"submitTime":1673225315159,"finishTime":1673225316269,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",3]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c44b166a-c71b-49e6-93e4-2791e786fa19"},{"version":"CommandV1","origId":4309478197827954,"guid":"5563d88b-5748-4dd2-bfe6-5da2f9ad1ed8","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.sql.types import StructType, StructField, IntegerType, StringType, DoubleType, FloatType\n","commandVersion":35,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317023,"submitTime":1673225315227,"finishTime":1673225317116,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"95ac9e23-66d5-4b90-ba34-94d89299713a"},{"version":"CommandV1","origId":4309478197827955,"guid":"b250c9ed-dc5d-4f08-adab-62c3d2441cc3","subtype":"command","commandType":"auto","position":2.5,"command":"result_schema = StructType (fields=[ StructField('resultId', IntegerType(), True),\n                                   StructField('raceId', IntegerType(), True),\n                                  StructField('driverId', IntegerType(), True),\n                                  StructField('constructorId', IntegerType(), True),\n                                  StructField('number', IntegerType(), True),\n                                  StructField('grid', IntegerType(), True),\n                                  StructField('position', IntegerType(), True),\n                                  StructField('positionText', StringType(), True),\n                                  StructField('positionOrder', IntegerType(), True),\n                                  StructField('points', FloatType(), True),\n                                  StructField('laps', IntegerType(), True),\n                                  StructField('time', StringType(), True),\n                                  StructField('milliseconds', IntegerType(), True),\n                                  StructField('fastestLap', IntegerType(), True),\n                                  StructField('rank', IntegerType(), True),\n                                  StructField('fastestLapTime', StringType(), True),\n                                  StructField('fastestLapSpeed', StringType(), True),\n                                  StructField('statusId', IntegerType(), True)\n                                  \n\n])","commandVersion":106,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317124,"submitTime":1673225315232,"finishTime":1673225317216,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e5ec4322-da64-42e6-9626-9ebf9d456ac4"},{"version":"CommandV1","origId":4309478197827957,"guid":"a1cd452a-3060-41ee-bb41-4f8aeb6735ed","subtype":"command","commandType":"auto","position":4.0,"command":"df_results = spark.read.schema(result_schema).json(f'{raw_folder_path}/{v_file_date}/results.json')\ndisplay(df_results)","commandVersion":51,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[24986,1053,830,9,33,3,1,"1",1,25.0,63,"2:02:34.598",7354598,60,2,"1:17.524","227.96",1],[24987,1053,1,131,44,1,2,"2",2,19.0,63,"+22.000",7376598,60,1,"1:16.702","230.403",1],[24988,1053,846,1,4,7,3,"3",3,15.0,63,"+23.702",7378300,63,3,"1:18.259","225.819",1],[24989,1053,844,6,16,4,4,"4",4,12.0,63,"+25.579",7380177,60,6,"1:18.379","225.473",1],[24990,1053,832,6,55,11,5,"5",5,10.0,63,"+27.036",7381634,60,7,"1:18.490","225.154",1],[24991,1053,817,1,3,6,6,"6",6,8.0,63,"+51.220",7405818,54,12,"1:19.341","222.739",1],[24992,1053,842,213,10,5,7,"7",7,6.0,63,"+52.818",7407416,52,9,"1:18.994","223.718",1],[24993,1053,840,117,18,10,8,"8",8,4.0,63,"+56.909",7411507,59,8,"1:18.782","224.32",1],[24994,1053,839,214,31,9,9,"9",9,2.0,63,"+65.704",7420302,62,15,"1:19.422","222.512",1],[24995,1053,4,214,14,15,10,"10",10,1.0,63,"+66.561",7421159,62,14,"1:19.417","222.526",1],[24996,1053,815,9,11,2,11,"11",11,0.0,63,"+67.151",7421749,62,13,"1:19.396","222.585",1],[24997,1053,852,213,22,20,12,"12",12,0.0,63,"+73.184",7427782,49,4,"1:18.334","225.603",1],[24998,1053,8,51,7,16,13,"13",13,0.0,63,"+94.773",7449371,62,5,"1:18.353","225.548",1],[24999,1053,841,51,99,17,14,"14",14,0.0,62,"\\N",null,57,16,"1:19.470","222.378",11],[25000,1053,20,117,5,0,15,"15",15,0.0,61,"\\N",null,59,10,"1:19.074","223.491",6],[25001,1053,854,210,47,18,16,"16",16,0.0,61,"\\N",null,58,11,"1:19.193","223.156",12],[25002,1053,853,210,9,19,17,"17",17,0.0,61,"\\N",null,55,17,"1:20.402","219.8",12],[25003,1053,822,131,77,8,null,"R",18,0.0,30,"\\N",null,30,19,"1:28.485","199.721",4],[25004,1053,847,3,63,12,null,"R",19,0.0,30,"\\N",null,28,18,"1:26.543","204.203",4],[25005,1053,849,3,6,14,null,"R",20,0.0,0,"\\N",null,null,0,"\\N","\\N",4]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"resultId","type":"\"integer\"","metadata":"{}"},{"name":"raceId","type":"\"integer\"","metadata":"{}"},{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"constructorId","type":"\"integer\"","metadata":"{}"},{"name":"number","type":"\"integer\"","metadata":"{}"},{"name":"grid","type":"\"integer\"","metadata":"{}"},{"name":"position","type":"\"integer\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"integer\"","metadata":"{}"},{"name":"points","type":"\"float\"","metadata":"{}"},{"name":"laps","type":"\"integer\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"},{"name":"milliseconds","type":"\"integer\"","metadata":"{}"},{"name":"fastestLap","type":"\"integer\"","metadata":"{}"},{"name":"rank","type":"\"integer\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"statusId","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_results","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"resultId","nullable":true,"type":"integer"},{"metadata":{},"name":"raceId","nullable":true,"type":"integer"},{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"constructorId","nullable":true,"type":"integer"},{"metadata":{},"name":"number","nullable":true,"type":"integer"},{"metadata":{},"name":"grid","nullable":true,"type":"integer"},{"metadata":{},"name":"position","nullable":true,"type":"integer"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"integer"},{"metadata":{},"name":"points","nullable":true,"type":"float"},{"metadata":{},"name":"laps","nullable":true,"type":"integer"},{"metadata":{},"name":"time","nullable":true,"type":"string"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"integer"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"integer"},{"metadata":{},"name":"rank","nullable":true,"type":"integer"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"statusId","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317224,"submitTime":1673225315237,"finishTime":1673225317517,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"39b645e9-b674-4a66-9b9d-e4d45fd19185"},{"version":"CommandV1","origId":4309478197827958,"guid":"bf7f60b5-39ed-4cdc-9bc7-4867acbde137","subtype":"command","commandType":"auto","position":5.0,"command":"df_results.printSchema()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"root\n |-- resultId: integer (nullable = true)\n |-- raceId: integer (nullable = true)\n |-- driverId: integer (nullable = true)\n |-- constructorId: integer (nullable = true)\n |-- number: integer (nullable = true)\n |-- grid: integer (nullable = true)\n |-- position: integer (nullable = true)\n |-- positionText: string (nullable = true)\n |-- positionOrder: integer (nullable = true)\n |-- points: float (nullable = true)\n |-- laps: integer (nullable = true)\n |-- time: string (nullable = true)\n |-- milliseconds: integer (nullable = true)\n |-- fastestLap: integer (nullable = true)\n |-- rank: integer (nullable = true)\n |-- fastestLapTime: string (nullable = true)\n |-- fastestLapSpeed: string (nullable = true)\n |-- statusId: integer (nullable = true)\n\n","name":null,"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317529,"submitTime":1673225315243,"finishTime":1673225317618,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",749]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"166db8a7-b38a-4084-86cd-11dc0e68f2f0"},{"version":"CommandV1","origId":4309478197827959,"guid":"1a4e3b52-73a7-47d9-8407-043ab6426548","subtype":"command","commandType":"auto","position":5.5,"command":"from pyspark.sql.functions import current_timestamp, lit, to_timestamp, concat, col","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317628,"submitTime":1673225315247,"finishTime":1673225317719,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d79cca51-f535-451a-ae67-7ebea328db1a"},{"version":"CommandV1","origId":4309478197827960,"guid":"40332d4b-38da-4655-826b-493c54ed56e7","subtype":"command","commandType":"auto","position":6.0,"command":"df_results_transformed = df_results.withColumnRenamed('resultId', 'result_id').withColumnRenamed('raceId', 'race_id').withColumnRenamed('driverId', 'driver_id').withColumnRenamed('contructorId', 'contructor_id').withColumnRenamed('positionText', 'position_text').withColumnRenamed('positionOrder', 'position_order').withColumnRenamed('fastestLap', 'fastest_lap').withColumnRenamed('fastestLapTime', 'fastest_lap_time').withColumnRenamed('fastestLapSpeed', 'fastest_lap_speed').drop('statusId')\n\ndf_results_transformed = add_ingestion_date(df_results_transformed).withColumn('data_source', lit(v_data_source)).withColumn('file_date', lit(v_file_date))\n\n\ndf_results_reduped= df_results_transformed.drop_duplicates(['race_id', 'driver_id'])\n","commandVersion":219,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_results_transformed","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"result_id","nullable":true,"type":"integer"},{"metadata":{},"name":"race_id","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_id","nullable":true,"type":"integer"},{"metadata":{},"name":"constructorId","nullable":true,"type":"integer"},{"metadata":{},"name":"number","nullable":true,"type":"integer"},{"metadata":{},"name":"grid","nullable":true,"type":"integer"},{"metadata":{},"name":"position","nullable":true,"type":"integer"},{"metadata":{},"name":"position_text","nullable":true,"type":"string"},{"metadata":{},"name":"position_order","nullable":true,"type":"integer"},{"metadata":{},"name":"points","nullable":true,"type":"float"},{"metadata":{},"name":"laps","nullable":true,"type":"integer"},{"metadata":{},"name":"time","nullable":true,"type":"string"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap","nullable":true,"type":"integer"},{"metadata":{},"name":"rank","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap_time","nullable":true,"type":"string"},{"metadata":{},"name":"fastest_lap_speed","nullable":true,"type":"string"},{"metadata":{},"name":"ingestion_date","nullable":false,"type":"timestamp"},{"metadata":{},"name":"data_source","nullable":false,"type":"string"},{"metadata":{},"name":"file_date","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"df_results_reduped","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"result_id","nullable":true,"type":"integer"},{"metadata":{},"name":"race_id","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_id","nullable":true,"type":"integer"},{"metadata":{},"name":"constructorId","nullable":true,"type":"integer"},{"metadata":{},"name":"number","nullable":true,"type":"integer"},{"metadata":{},"name":"grid","nullable":true,"type":"integer"},{"metadata":{},"name":"position","nullable":true,"type":"integer"},{"metadata":{},"name":"position_text","nullable":true,"type":"string"},{"metadata":{},"name":"position_order","nullable":true,"type":"integer"},{"metadata":{},"name":"points","nullable":true,"type":"float"},{"metadata":{},"name":"laps","nullable":true,"type":"integer"},{"metadata":{},"name":"time","nullable":true,"type":"string"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap","nullable":true,"type":"integer"},{"metadata":{},"name":"rank","nullable":true,"type":"integer"},{"metadata":{},"name":"fastest_lap_time","nullable":true,"type":"string"},{"metadata":{},"name":"fastest_lap_speed","nullable":true,"type":"string"},{"metadata":{},"name":"ingestion_date","nullable":false,"type":"timestamp"},{"metadata":{},"name":"data_source","nullable":false,"type":"string"},{"metadata":{},"name":"file_date","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317727,"submitTime":1673225315252,"finishTime":1673225317819,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"18951bdf-c48f-4e5f-b686-20e045088df1"},{"version":"CommandV1","origId":4309478197827961,"guid":"8f331279-7dfa-44ea-97dc-613f372e4aa6","subtype":"command","commandType":"auto","position":7.0,"command":"display(df_results_transformed)","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[24986,1053,830,9,33,3,1,"1",1,25.0,63,"2:02:34.598",7354598,60,2,"1:17.524","227.96","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24987,1053,1,131,44,1,2,"2",2,19.0,63,"+22.000",7376598,60,1,"1:16.702","230.403","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24988,1053,846,1,4,7,3,"3",3,15.0,63,"+23.702",7378300,63,3,"1:18.259","225.819","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24989,1053,844,6,16,4,4,"4",4,12.0,63,"+25.579",7380177,60,6,"1:18.379","225.473","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24990,1053,832,6,55,11,5,"5",5,10.0,63,"+27.036",7381634,60,7,"1:18.490","225.154","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24991,1053,817,1,3,6,6,"6",6,8.0,63,"+51.220",7405818,54,12,"1:19.341","222.739","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24992,1053,842,213,10,5,7,"7",7,6.0,63,"+52.818",7407416,52,9,"1:18.994","223.718","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24993,1053,840,117,18,10,8,"8",8,4.0,63,"+56.909",7411507,59,8,"1:18.782","224.32","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24994,1053,839,214,31,9,9,"9",9,2.0,63,"+65.704",7420302,62,15,"1:19.422","222.512","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24995,1053,4,214,14,15,10,"10",10,1.0,63,"+66.561",7421159,62,14,"1:19.417","222.526","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24996,1053,815,9,11,2,11,"11",11,0.0,63,"+67.151",7421749,62,13,"1:19.396","222.585","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24997,1053,852,213,22,20,12,"12",12,0.0,63,"+73.184",7427782,49,4,"1:18.334","225.603","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24998,1053,8,51,7,16,13,"13",13,0.0,63,"+94.773",7449371,62,5,"1:18.353","225.548","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[24999,1053,841,51,99,17,14,"14",14,0.0,62,"\\N",null,57,16,"1:19.470","222.378","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[25000,1053,20,117,5,0,15,"15",15,0.0,61,"\\N",null,59,10,"1:19.074","223.491","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[25001,1053,854,210,47,18,16,"16",16,0.0,61,"\\N",null,58,11,"1:19.193","223.156","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[25002,1053,853,210,9,19,17,"17",17,0.0,61,"\\N",null,55,17,"1:20.402","219.8","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[25003,1053,822,131,77,8,null,"R",18,0.0,30,"\\N",null,30,19,"1:28.485","199.721","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[25004,1053,847,3,63,12,null,"R",19,0.0,30,"\\N",null,28,18,"1:26.543","204.203","2023-01-09T00:48:37.843+0000","testing","2021-04-18"],[25005,1053,849,3,6,14,null,"R",20,0.0,0,"\\N",null,null,0,"\\N","\\N","2023-01-09T00:48:37.843+0000","testing","2021-04-18"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"result_id","type":"\"integer\"","metadata":"{}"},{"name":"race_id","type":"\"integer\"","metadata":"{}"},{"name":"driver_id","type":"\"integer\"","metadata":"{}"},{"name":"constructorId","type":"\"integer\"","metadata":"{}"},{"name":"number","type":"\"integer\"","metadata":"{}"},{"name":"grid","type":"\"integer\"","metadata":"{}"},{"name":"position","type":"\"integer\"","metadata":"{}"},{"name":"position_text","type":"\"string\"","metadata":"{}"},{"name":"position_order","type":"\"integer\"","metadata":"{}"},{"name":"points","type":"\"float\"","metadata":"{}"},{"name":"laps","type":"\"integer\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"},{"name":"milliseconds","type":"\"integer\"","metadata":"{}"},{"name":"fastest_lap","type":"\"integer\"","metadata":"{}"},{"name":"rank","type":"\"integer\"","metadata":"{}"},{"name":"fastest_lap_time","type":"\"string\"","metadata":"{}"},{"name":"fastest_lap_speed","type":"\"string\"","metadata":"{}"},{"name":"ingestion_date","type":"\"timestamp\"","metadata":"{}"},{"name":"data_source","type":"\"string\"","metadata":"{}"},{"name":"file_date","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225317827,"submitTime":1673225315257,"finishTime":1673225318020,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"138976ef-b60e-489c-83f6-39585e157b45"},{"version":"CommandV1","origId":4309478197827964,"guid":"faad85ab-daf1-4844-ab19-973008028773","subtype":"command","commandType":"auto","position":13.0,"command":"dbutils.notebook.exit('Success')","commandVersion":1,"state":"finished","results":{"type":"raw","data":"Success","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673225336281,"submitTime":1673225315273,"finishTime":1673225336371,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["exit",7]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6d318a98-6bbe-4def-ab6c-110e03fbd171"}],"dashboards":[],"guid":"a3b3c2af-0e12-4a28-a4cc-fb565a5df9c2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"p_data_source":{"nuid":"e3f272ee-adb1-4768-b41d-91b3daec0799","currentValue":"testing","widgetInfo":{"widgetType":"text","name":"p_data_source","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}},"typedWidgetInfo":null},"p_file_date":{"nuid":"2125df22-d9dd-407e-98d6-817b0826d96a","currentValue":"2021-04-18","widgetInfo":{"widgetType":"text","name":"p_file_date","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}},"typedWidgetInfo":null}},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":296404507370948,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE","environmentMetadata":null}