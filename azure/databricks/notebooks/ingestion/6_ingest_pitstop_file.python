{"version":"NotebookV1","origId":4309478197827965,"name":"6_ingest_pitstop_file","language":"python","commands":[{"version":"CommandV1","origId":12687888541973,"guid":"c8c41297-4ff4-49a4-a21f-9fa44e2dc18d","subtype":"command","commandType":"auto","position":1.25,"command":"%run \"../includes/configuration\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224720753,"submitTime":1673224720753,"finishTime":1673224722167,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"91267a84-fade-4b03-a471-72a39e5ec6f4"},{"version":"CommandV1","origId":12687888541980,"guid":"7a0c69bf-84f0-4ea2-85bd-51fd3700e283","subtype":"command","commandType":"auto","position":1.625,"command":"%run \"../includes/common_functions\"","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224720762,"submitTime":1673224720762,"finishTime":1673224722836,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0f955aa9-c25a-4cc1-aca1-91999cb3ed41"},{"version":"CommandV1","origId":296404507371002,"guid":"482143bf-1dc1-4de7-bdbd-71eac416af32","subtype":"command","commandType":"auto","position":1.0625,"command":"dbutils.widgets.text(\"p_file_date\", \"2021-03-21\")\nv_file_date = dbutils.widgets.get(\"p_file_date\")","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{"p_file_date":"2021-04-18"},"addedWidgets":{"p_file_date":{"widgetType":"text","name":"p_file_date","defaultValue":"2021-03-21","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224721842,"submitTime":1673224720748,"finishTime":1673224721935,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4268a156-b39c-4a7a-ae13-647a0afb0525"},{"version":"CommandV1","origId":3029141207068711,"guid":"49f60581-2b59-477e-aa38-7639aa178e62","subtype":"command","commandType":"auto","position":14.0,"command":"%sql\n\nselect distinct file_date from f1_processed.pit_stops","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["2021-03-21"],["2021-04-18"],["2021-03-28"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"file_date","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"file_date","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224740041,"submitTime":1673224740007,"finishTime":1673224742770,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",3]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b325ed35-64fb-45f4-91cd-d3944263abef"},{"version":"CommandV1","origId":3029141207068718,"guid":"83fe23bd-138d-4aea-8a57-c5709193a004","subtype":"command","commandType":"auto","position":15.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"be21423e-1ab1-4cbc-903f-47e55d4e6ab6"},{"version":"CommandV1","origId":3029141207068758,"guid":"8cf1be01-3cab-4295-9544-9369347081f3","subtype":"script","commandType":"auto","position":1.75,"command":"","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224721944,"submitTime":0,"finishTime":1673224722035,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c8c41297-4ff4-49a4-a21f-9fa44e2dc18d"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"841854ce-abf8-4e14-b0b4-472ed90b4801"},{"version":"CommandV1","origId":3029141207068759,"guid":"861b1403-dbab-49ac-a205-451f06bfd1c4","subtype":"script","commandType":"auto","position":1.7916666666666667,"command":"","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722043,"submitTime":0,"finishTime":1673224722136,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7a0c69bf-84f0-4ea2-85bd-51fd3700e283"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3ddce3dc-fd04-43d8-a956-fc796ef9b079"},{"version":"CommandV1","origId":3029141207068760,"guid":"f9e0aee2-5d45-4d07-a114-b9aa0f276e43","subtype":"script","commandType":"auto","position":1.9583333333333333,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722144,"submitTime":0,"finishTime":1673224722236,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7a0c69bf-84f0-4ea2-85bd-51fd3700e283"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"226793fc-fd55-42cf-beb8-075cbc26e311"},{"version":"CommandV1","origId":3029141207068761,"guid":"6e9ac483-c5ec-4727-a505-a13ccf9d9273","subtype":"script","commandType":"auto","position":2.125,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722245,"submitTime":0,"finishTime":1673224722337,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7a0c69bf-84f0-4ea2-85bd-51fd3700e283"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b4f8851c-cac2-4e36-9d73-dff1ca6844e4"},{"version":"CommandV1","origId":3029141207068762,"guid":"bbd5ff53-c0dd-4e7e-b52d-dec79c4050de","subtype":"script","commandType":"auto","position":2.2916666666666665,"command":"","commandVersion":113,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722346,"submitTime":0,"finishTime":1673224722438,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7a0c69bf-84f0-4ea2-85bd-51fd3700e283"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72b673ba-24e9-48fc-9810-5af243c6dc07"},{"version":"CommandV1","origId":3029141207068763,"guid":"5eeaf91b-f58c-404e-b491-8d72e4080ca1","subtype":"script","commandType":"auto","position":2.4583333333333335,"command":"","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722447,"submitTime":0,"finishTime":1673224722538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["7a0c69bf-84f0-4ea2-85bd-51fd3700e283"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d310cced-5431-45b3-8b29-0bfade2e1e15"},{"version":"CommandV1","origId":4190428027509666,"guid":"3387a7db-feda-489b-b8ec-b42c422887b1","subtype":"command","commandType":"auto","position":0.875,"command":"dbutils.widgets.text('p_data_source', '')\nv_data_source = dbutils.widgets.get('p_data_source')\n","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{"p_data_source":"testing"},"addedWidgets":{"p_data_source":{"widgetType":"text","name":"p_data_source","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}}},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224721817,"submitTime":1673224720742,"finishTime":1673224721834,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6c29a763-3082-4c0b-86d9-b388003e9530"},{"version":"CommandV1","origId":4309478197827966,"guid":"5b334bd9-e81d-4cf4-8312-bff93aa9f0be","subtype":"command","commandType":"auto","position":0.5,"command":"%fs\nls /mnt/formula1dljavi/raw/\n","commandVersion":41,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/formula1dljavi/raw/2021-03-21/","2021-03-21/",0,1673110566000],["dbfs:/mnt/formula1dljavi/raw/2021-03-28/","2021-03-28/",0,1673110566000],["dbfs:/mnt/formula1dljavi/raw/2021-04-18/","2021-04-18/",0,1673110566000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"},{"name":"modificationTime","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224720890,"submitTime":1673224720737,"finishTime":1673224721807,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",3]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c44b166a-c71b-49e6-93e4-2791e786fa19"},{"version":"CommandV1","origId":4309478197827967,"guid":"a9167876-5c33-455f-b2bc-c45859423650","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.sql.types import StructType, StructField, IntegerType, StringType, DoubleType, FloatType\n","commandVersion":35,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722546,"submitTime":1673224720778,"finishTime":1673224722638,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"95ac9e23-66d5-4b90-ba34-94d89299713a"},{"version":"CommandV1","origId":4309478197827968,"guid":"b7d85e3b-b0dd-4d73-b33e-28bfacc26280","subtype":"command","commandType":"auto","position":2.5,"command":"pitstop_schema = StructType (fields=[StructField('raceId', IntegerType(), True),\n                                  StructField('driverId', IntegerType(), True),\n                                  StructField('stop', StringType(), True),\n                                  StructField('lap', IntegerType(), True),\n                                  StructField('time', StringType(), True),\n                                  StructField('duration', StringType(), True),\n                                  StructField('milliseconds', IntegerType(), True)\n                                  \n\n])","commandVersion":126,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722647,"submitTime":1673224720783,"finishTime":1673224722739,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e5ec4322-da64-42e6-9626-9ebf9d456ac4"},{"version":"CommandV1","origId":4309478197827969,"guid":"b7f7a2df-7cb1-410b-b1bf-10c058010bde","subtype":"command","commandType":"auto","position":4.0,"command":"df_pitstops = spark.read.schema(pitstop_schema).option('multiLine', True).json(f'{raw_folder_path}/{v_file_date}/pit_stops.json')\ndisplay(df_pitstops)","commandVersion":67,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1053,839,"1",1,"15:05:16","30.866",30866],[1053,20,"1",3,"15:10:09","32.024",32024],[1053,854,"1",5,"15:15:11","51.007",51007],[1053,853,"1",12,"15:27:20","31.168",31168],[1053,842,"1",14,"15:30:10","31.068",31068],[1053,20,"2",20,"15:39:11","31.184",31184],[1053,854,"2",21,"15:41:24","32.479",32479],[1053,20,"3",22,"15:42:52","39.502",39502],[1053,853,"2",23,"15:45:20","31.5",31500],[1053,852,"1",25,"15:46:39","30.696",30696],[1053,847,"1",26,"15:47:53","29.983",29983],[1053,8,"1",26,"15:47:55","30.28",30280],[1053,830,"1",27,"15:47:59","29.809",29809],[1053,842,"2",26,"15:48:45","32.277",32277],[1053,832,"1",27,"15:48:51","30.856",30856],[1053,817,"1",27,"15:48:57","34.34",34340],[1053,840,"1",27,"15:49:16","31.138",31138],[1053,1,"1",28,"15:49:27","32.112",32112],[1053,841,"1",27,"15:49:32","32.299",32299],[1053,839,"2",27,"15:49:42","30.652",30652],[1053,844,"1",28,"15:49:43","31.002",31002],[1053,815,"1",28,"15:49:58","44.608",44608],[1053,846,"1",28,"15:50:11","30.654",30654],[1053,822,"1",28,"15:50:46","30.167",30167],[1053,4,"1",28,"15:51:18","30.864",30864],[1053,1,"2",31,"15:55:30","38.198",38198],[1053,839,"3",31,"15:56:23","30.701",30701],[1053,830,"2",33,"15:58:11","27:01.361",1621361],[1053,840,"2",32,"15:58:13","24:52.090",1492090],[1053,8,"2",32,"15:58:16","24:52.612",1492612],[1053,1,"3",32,"15:58:17","24:54.731",1494731],[1053,854,"3",31,"15:58:20","25:21.462",1521462],[1053,852,"2",32,"15:58:24","24:51.384",1491384],[1053,841,"2",32,"15:58:26","24:56.541",1496541],[1053,844,"2",33,"15:58:28","26:49.484",1609484],[1053,4,"2",32,"15:58:37","24:48.372",1488372],[1053,839,"4",32,"15:58:48","24:38.974",1478974],[1053,853,"3",31,"15:58:57","24:46.154",1486154],[1053,846,"2",33,"15:59:06","26:24.953",1584953],[1053,815,"2",33,"15:59:11","26:21.158",1581158],[1053,832,"2",33,"15:59:14","26:22.211",1582211],[1053,842,"3",32,"15:59:18","24:13.539",1453539],[1053,20,"4",32,"15:59:21","24:12.323",1452323],[1053,817,"2",33,"15:59:25","26:14.827",1574827],[1053,840,"3",33,"16:24:36","1:05.390",65390],[1053,8,"3",33,"16:24:42","1:02.892",62892],[1053,1,"4",33,"16:24:48","1:05.870",65870],[1053,852,"3",33,"16:24:52","1:03.280",63280],[1053,841,"3",33,"16:24:58","1:00.172",60172],[1053,4,"3",33,"16:25:04","57.601",57601],[1053,839,"5",33,"16:25:06","56.733",56733],[1053,842,"4",33,"16:25:09","56.083",56083],[1053,20,"5",33,"16:25:15","52.043",52043],[1053,854,"4",32,"16:25:16","51.222",51222],[1053,853,"4",32,"16:25:22","49.729",49729],[1053,841,"4",40,"16:36:13","29.742",29742]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"raceId","type":"\"integer\"","metadata":"{}"},{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"stop","type":"\"string\"","metadata":"{}"},{"name":"lap","type":"\"integer\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"},{"name":"duration","type":"\"string\"","metadata":"{}"},{"name":"milliseconds","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_pitstops","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"raceId","nullable":true,"type":"integer"},{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"stop","nullable":true,"type":"string"},{"metadata":{},"name":"lap","nullable":true,"type":"integer"},{"metadata":{},"name":"time","nullable":true,"type":"string"},{"metadata":{},"name":"duration","nullable":true,"type":"string"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224722749,"submitTime":1673224720788,"finishTime":1673224723040,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",56]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"39b645e9-b674-4a66-9b9d-e4d45fd19185"},{"version":"CommandV1","origId":4309478197827970,"guid":"627f9752-86e1-408d-b956-fe09c95603a1","subtype":"command","commandType":"auto","position":5.0,"command":"df_pitstops.printSchema()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"root\n |-- raceId: integer (nullable = true)\n |-- driverId: integer (nullable = true)\n |-- stop: string (nullable = true)\n |-- lap: integer (nullable = true)\n |-- time: string (nullable = true)\n |-- duration: string (nullable = true)\n |-- milliseconds: integer (nullable = true)\n\n","name":null,"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224723053,"submitTime":1673224720794,"finishTime":1673224723140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",279]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"166db8a7-b38a-4084-86cd-11dc0e68f2f0"},{"version":"CommandV1","origId":4309478197827971,"guid":"feb87a0d-13a6-41af-b994-418988974c6d","subtype":"command","commandType":"auto","position":5.5,"command":"from pyspark.sql.functions import current_timestamp, lit, to_timestamp, concat, col","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224723150,"submitTime":1673224720799,"finishTime":1673224723241,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d79cca51-f535-451a-ae67-7ebea328db1a"},{"version":"CommandV1","origId":4309478197827972,"guid":"0dbe3c0a-cb6c-41a7-bdd4-58f3955cdb7a","subtype":"command","commandType":"auto","position":6.0,"command":"df_pitstops_transformed = df_pitstops.withColumnRenamed('raceId', 'race_id').withColumnRenamed('driverId', 'driver_id')\n\ndf_pitstops_transformed= add_ingestion_date(df_pitstops_transformed).withColumn('data_source', lit(v_data_source)).withColumn(\"file_date\", lit(v_file_date))\n\n\ndisplay(df_pitstops_transformed)\n","commandVersion":211,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1053,839,"1",1,"15:05:16","30.866",30866,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,20,"1",3,"15:10:09","32.024",32024,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,854,"1",5,"15:15:11","51.007",51007,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,853,"1",12,"15:27:20","31.168",31168,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,842,"1",14,"15:30:10","31.068",31068,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,20,"2",20,"15:39:11","31.184",31184,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,854,"2",21,"15:41:24","32.479",32479,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,20,"3",22,"15:42:52","39.502",39502,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,853,"2",23,"15:45:20","31.5",31500,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,852,"1",25,"15:46:39","30.696",30696,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,847,"1",26,"15:47:53","29.983",29983,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,8,"1",26,"15:47:55","30.28",30280,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,830,"1",27,"15:47:59","29.809",29809,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,842,"2",26,"15:48:45","32.277",32277,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,832,"1",27,"15:48:51","30.856",30856,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,817,"1",27,"15:48:57","34.34",34340,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,840,"1",27,"15:49:16","31.138",31138,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,1,"1",28,"15:49:27","32.112",32112,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,841,"1",27,"15:49:32","32.299",32299,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,839,"2",27,"15:49:42","30.652",30652,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,844,"1",28,"15:49:43","31.002",31002,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,815,"1",28,"15:49:58","44.608",44608,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,846,"1",28,"15:50:11","30.654",30654,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,822,"1",28,"15:50:46","30.167",30167,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,4,"1",28,"15:51:18","30.864",30864,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,1,"2",31,"15:55:30","38.198",38198,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,839,"3",31,"15:56:23","30.701",30701,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,830,"2",33,"15:58:11","27:01.361",1621361,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,840,"2",32,"15:58:13","24:52.090",1492090,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,8,"2",32,"15:58:16","24:52.612",1492612,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,1,"3",32,"15:58:17","24:54.731",1494731,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,854,"3",31,"15:58:20","25:21.462",1521462,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,852,"2",32,"15:58:24","24:51.384",1491384,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,841,"2",32,"15:58:26","24:56.541",1496541,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,844,"2",33,"15:58:28","26:49.484",1609484,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,4,"2",32,"15:58:37","24:48.372",1488372,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,839,"4",32,"15:58:48","24:38.974",1478974,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,853,"3",31,"15:58:57","24:46.154",1486154,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,846,"2",33,"15:59:06","26:24.953",1584953,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,815,"2",33,"15:59:11","26:21.158",1581158,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,832,"2",33,"15:59:14","26:22.211",1582211,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,842,"3",32,"15:59:18","24:13.539",1453539,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,20,"4",32,"15:59:21","24:12.323",1452323,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,817,"2",33,"15:59:25","26:14.827",1574827,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,840,"3",33,"16:24:36","1:05.390",65390,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,8,"3",33,"16:24:42","1:02.892",62892,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,1,"4",33,"16:24:48","1:05.870",65870,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,852,"3",33,"16:24:52","1:03.280",63280,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,841,"3",33,"16:24:58","1:00.172",60172,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,4,"3",33,"16:25:04","57.601",57601,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,839,"5",33,"16:25:06","56.733",56733,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,842,"4",33,"16:25:09","56.083",56083,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,20,"5",33,"16:25:15","52.043",52043,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,854,"4",32,"16:25:16","51.222",51222,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,853,"4",32,"16:25:22","49.729",49729,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"],[1053,841,"4",40,"16:36:13","29.742",29742,"2023-01-09T00:38:43.299+0000","testing","2021-04-18"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"race_id","type":"\"integer\"","metadata":"{}"},{"name":"driver_id","type":"\"integer\"","metadata":"{}"},{"name":"stop","type":"\"string\"","metadata":"{}"},{"name":"lap","type":"\"integer\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"},{"name":"duration","type":"\"string\"","metadata":"{}"},{"name":"milliseconds","type":"\"integer\"","metadata":"{}"},{"name":"ingestion_date","type":"\"timestamp\"","metadata":"{}"},{"name":"data_source","type":"\"string\"","metadata":"{}"},{"name":"file_date","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_pitstops_transformed","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"race_id","nullable":true,"type":"integer"},{"metadata":{},"name":"driver_id","nullable":true,"type":"integer"},{"metadata":{},"name":"stop","nullable":true,"type":"string"},{"metadata":{},"name":"lap","nullable":true,"type":"integer"},{"metadata":{},"name":"time","nullable":true,"type":"string"},{"metadata":{},"name":"duration","nullable":true,"type":"string"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"integer"},{"metadata":{},"name":"ingestion_date","nullable":false,"type":"timestamp"},{"metadata":{},"name":"data_source","nullable":false,"type":"string"},{"metadata":{},"name":"file_date","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224723250,"submitTime":1673224720804,"finishTime":1673224723442,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",56]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"18951bdf-c48f-4e5f-b686-20e045088df1"},{"version":"CommandV1","origId":4309478197827973,"guid":"56a65213-ddf3-44e6-9e1a-5a508421590e","subtype":"command","commandType":"auto","position":7.0,"command":"display(df_pitstops_transformed)","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1053,839,"1",1,"15:05:16","30.866",30866,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,20,"1",3,"15:10:09","32.024",32024,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,854,"1",5,"15:15:11","51.007",51007,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,853,"1",12,"15:27:20","31.168",31168,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,842,"1",14,"15:30:10","31.068",31068,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,20,"2",20,"15:39:11","31.184",31184,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,854,"2",21,"15:41:24","32.479",32479,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,20,"3",22,"15:42:52","39.502",39502,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,853,"2",23,"15:45:20","31.5",31500,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,852,"1",25,"15:46:39","30.696",30696,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,847,"1",26,"15:47:53","29.983",29983,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,8,"1",26,"15:47:55","30.28",30280,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,830,"1",27,"15:47:59","29.809",29809,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,842,"2",26,"15:48:45","32.277",32277,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,832,"1",27,"15:48:51","30.856",30856,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,817,"1",27,"15:48:57","34.34",34340,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,840,"1",27,"15:49:16","31.138",31138,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,1,"1",28,"15:49:27","32.112",32112,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,841,"1",27,"15:49:32","32.299",32299,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,839,"2",27,"15:49:42","30.652",30652,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,844,"1",28,"15:49:43","31.002",31002,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,815,"1",28,"15:49:58","44.608",44608,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,846,"1",28,"15:50:11","30.654",30654,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,822,"1",28,"15:50:46","30.167",30167,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,4,"1",28,"15:51:18","30.864",30864,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,1,"2",31,"15:55:30","38.198",38198,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,839,"3",31,"15:56:23","30.701",30701,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,830,"2",33,"15:58:11","27:01.361",1621361,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,840,"2",32,"15:58:13","24:52.090",1492090,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,8,"2",32,"15:58:16","24:52.612",1492612,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,1,"3",32,"15:58:17","24:54.731",1494731,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,854,"3",31,"15:58:20","25:21.462",1521462,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,852,"2",32,"15:58:24","24:51.384",1491384,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,841,"2",32,"15:58:26","24:56.541",1496541,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,844,"2",33,"15:58:28","26:49.484",1609484,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,4,"2",32,"15:58:37","24:48.372",1488372,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,839,"4",32,"15:58:48","24:38.974",1478974,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,853,"3",31,"15:58:57","24:46.154",1486154,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,846,"2",33,"15:59:06","26:24.953",1584953,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,815,"2",33,"15:59:11","26:21.158",1581158,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,832,"2",33,"15:59:14","26:22.211",1582211,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,842,"3",32,"15:59:18","24:13.539",1453539,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,20,"4",32,"15:59:21","24:12.323",1452323,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,817,"2",33,"15:59:25","26:14.827",1574827,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,840,"3",33,"16:24:36","1:05.390",65390,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,8,"3",33,"16:24:42","1:02.892",62892,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,1,"4",33,"16:24:48","1:05.870",65870,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,852,"3",33,"16:24:52","1:03.280",63280,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,841,"3",33,"16:24:58","1:00.172",60172,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,4,"3",33,"16:25:04","57.601",57601,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,839,"5",33,"16:25:06","56.733",56733,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,842,"4",33,"16:25:09","56.083",56083,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,20,"5",33,"16:25:15","52.043",52043,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,854,"4",32,"16:25:16","51.222",51222,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,853,"4",32,"16:25:22","49.729",49729,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"],[1053,841,"4",40,"16:36:13","29.742",29742,"2023-01-09T00:38:43.468+0000","testing","2021-04-18"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"race_id","type":"\"integer\"","metadata":"{}"},{"name":"driver_id","type":"\"integer\"","metadata":"{}"},{"name":"stop","type":"\"string\"","metadata":"{}"},{"name":"lap","type":"\"integer\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"},{"name":"duration","type":"\"string\"","metadata":"{}"},{"name":"milliseconds","type":"\"integer\"","metadata":"{}"},{"name":"ingestion_date","type":"\"timestamp\"","metadata":"{}"},{"name":"data_source","type":"\"string\"","metadata":"{}"},{"name":"file_date","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224723452,"submitTime":1673224720810,"finishTime":1673224723644,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",56]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"138976ef-b60e-489c-83f6-39585e157b45"},{"version":"CommandV1","origId":4309478197827974,"guid":"180cdb26-4233-4839-9868-a4afa0daa06b","subtype":"command","commandType":"auto","position":11.0,"command":"\nmerge_condition = 'a.driver_id = b.driver_id and a.race_id = b.race_id and a.stop = b.stop'\nmerge_delta_data(df_pitstops_transformed, 'f1_processed', 'pit_stops', processed_folder_path, merge_condition, 'race_id')","commandVersion":79,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224723654,"submitTime":1673224720815,"finishTime":1673224728253,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8e9299db-17e6-4d0b-b3f3-02977e94fd53"},{"version":"CommandV1","origId":4309478197827976,"guid":"e16fafb7-3b93-46f4-a279-bf934fc5e5cd","subtype":"command","commandType":"auto","position":13.0,"command":"dbutils.notebook.exit('Success')","commandVersion":1,"state":"finished","results":{"type":"raw","data":"Success","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673224728268,"submitTime":1673224720820,"finishTime":1673224728353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["exit",7]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6d318a98-6bbe-4def-ab6c-110e03fbd171"}],"dashboards":[],"guid":"1c36dd30-d18c-4061-8cf6-07d798f52fc0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{"p_data_source":{"nuid":"7ef9bbc1-1ad1-4512-9e8c-55398d6829a7","currentValue":"testing","widgetInfo":{"widgetType":"text","name":"p_data_source","defaultValue":"","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}},"typedWidgetInfo":null},"p_file_date":{"nuid":"5ee1a859-3108-4c91-9b73-98b46593f9fc","currentValue":"2021-04-18","widgetInfo":{"widgetType":"text","name":"p_file_date","defaultValue":"2021-03-21","label":null,"options":{"widgetType":"text","validationRegex":null,"autoCreated":null}},"typedWidgetInfo":null}},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":3029141207068711,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE","environmentMetadata":null}