{"version":"NotebookV1","origId":65578720055462,"name":"10_delta_lake_demo","language":"python","commands":[{"version":"CommandV1","origId":65578720055463,"guid":"b168a3aa-177a-4f77-b87b-b76e741e9910","subtype":"command","commandType":"auto","position":1.0,"command":"%sql\n\ncreate database if not exists f1_demo\nlocation '/mnt/formula1dljavi/demo'","commandVersion":18,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673204963211,"submitTime":1673204962329,"finishTime":1673204964936,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b2109fb4-7369-4ed8-9a58-38eb35328736"},{"version":"CommandV1","origId":65578720055466,"guid":"974bcac5-d632-4d59-b11d-1ffad8835bdf","subtype":"command","commandType":"auto","position":2.0,"command":"results_df = spark.read.option('inferSchema', True).json('/mnt/formula1dljavi/raw/2021-03-28/results.json')","commandVersion":60,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"results_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205125454,"submitTime":1673205125425,"finishTime":1673205125964,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"eab66aac-b02c-4e0c-85dc-b4bc6ea6f199"},{"version":"CommandV1","origId":65578720055467,"guid":"a27bb398-e55a-4316-a173-826e6fce7504","subtype":"command","commandType":"auto","position":3.0,"command":"results_df.write.format('delta').mode('overwrite').saveAsTable('f1_demo.results_managed')","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205314004,"submitTime":1673205313679,"finishTime":1673205327099,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4b543037-8b57-4428-be4f-7716cde32d99"},{"version":"CommandV1","origId":65578720055468,"guid":"09b9ccc6-6ba7-4303-a9ba-c29e47f74bc4","subtype":"command","commandType":"auto","position":4.0,"command":"%sql \n\nshow databases;","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["default"],["demo"],["f1_demo"],["f1_presentation"],["f1_processed"],["f1_raw"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"databaseName","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"databaseName","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205344708,"submitTime":1673205344681,"finishTime":1673205344928,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",6]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"af495479-8ac3-40dc-82e4-6c55ebb0d55f"},{"version":"CommandV1","origId":65578720055469,"guid":"101e74e3-e8cd-48ed-93c9-a77cb85a2272","subtype":"command","commandType":"auto","position":5.0,"command":"%sql \nuse f1_demo","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205362844,"submitTime":1673205362816,"finishTime":1673205362955,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ca08d50b-c073-45cb-ba6d-f5b4accda440"},{"version":"CommandV1","origId":65578720055470,"guid":"725a6d5f-848d-4a80-ab3a-66db8939cbfc","subtype":"command","commandType":"auto","position":6.0,"command":"%sql\nshow tables","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["f1_demo","results_managed",false]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"database","type":"\"string\"","metadata":"{}"},{"name":"tableName","type":"\"string\"","metadata":"{}"},{"name":"isTemporary","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"database","nullable":false,"type":"string"},{"metadata":{},"name":"tableName","nullable":false,"type":"string"},{"metadata":{},"name":"isTemporary","nullable":false,"type":"boolean"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205372959,"submitTime":1673205372935,"finishTime":1673205373166,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f59d211d-6759-497e-8cc4-80401fdf01b2"},{"version":"CommandV1","origId":65578720055471,"guid":"428c56cf-f3b9-4627-9932-4e333721cbd1","subtype":"command","commandType":"auto","position":7.0,"command":"%sql\n\nselect * from f1_demo.results_managed","commandVersion":29,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,25,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,18,"2",2,"2",1052,2,24967,1,"+0.745"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,16,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,12,"4",4,"4",1052,6,24969,1,"+46.466"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,10,"5",5,"5",1052,3,24970,1,"+52.047"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,8,"6",6,"6",1052,11,24971,1,"+59.090"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,6,"7",7,"7",1052,10,24972,1,"+66.004"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,4,"8",8,"8",1052,7,24973,1,"+67.100"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,2,"9",9,"9",1052,8,24974,1,"+85.692"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,1,"10",10,"10",1052,9,24975,1,"+86.713"],[51,8,"45","204.672","1:35.192",14,56,"5612761",7,0,"11",11,"11",1052,14,24976,1,"+88.864"],[51,841,"32","204.823","1:35.122",12,55,"\\N",99,0,"12",12,"12",1052,13,24977,11,"\\N"],[214,839,"33","204.548","1:35.250",16,55,"\\N",31,0,"13",13,"13",1052,15,24978,11,"\\N"],[3,847,"40","205.008","1:35.036",15,55,"\\N",63,0,"14",14,"14",1052,12,24979,11,"\\N"],[117,20,"26","203.871","1:35.566",20,55,"\\N",5,0,"15",15,"15",1052,16,24980,11,"\\N"],[210,854,"38","202.667","1:36.134",18,55,"\\N",47,0,"16",16,"16",1052,18,24981,11,"\\N"],[213,842,"48","207.069","1:34.090",5,52,"\\N",10,0,"17",17,"17",1052,5,24982,31,"\\N"],[3,849,"16","201.685","1:36.602",17,51,"\\N",6,0,"18",18,"18",1052,19,24983,31,"\\N"],[214,4,"31","202.816","1:36.063",9,32,"\\N",14,0,"\\N",19,"R",1052,17,24984,23,"\\N"],[210,853,"\\N","\\N","\\N",19,0,"\\N",9,0,"\\N",20,"R",1052,0,24985,3,"\\N"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205446465,"submitTime":1673205446178,"finishTime":1673205451161,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ac7fb8e6-bc77-4137-8a49-464c18088de7"},{"version":"CommandV1","origId":65578720055472,"guid":"1000a29f-d33e-42bc-8909-cfd733d216db","subtype":"command","commandType":"auto","position":8.0,"command":"results_df.write.format('delta').mode('overwrite').save('/mnt/formula1dljavi/demo/results_external')","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205512363,"submitTime":1673205512338,"finishTime":1673205515132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a260321b-a288-4569-8bfb-1a347bde33d9"},{"version":"CommandV1","origId":65578720055473,"guid":"b75104e7-454a-4316-9f9c-399e6f26614e","subtype":"command","commandType":"auto","position":9.0,"command":"%sql\n\ncreate table f1_demo.results_external\nusing DELTA\nlocation \"/mnt/formula1dljavi/demo/results_external\"","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205616400,"submitTime":1673205616354,"finishTime":1673205617130,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"55c63018-1511-4321-8dab-2dd7bb6dc564"},{"version":"CommandV1","origId":65578720055474,"guid":"31660242-aa06-474b-9e1f-a78351432186","subtype":"command","commandType":"auto","position":10.0,"command":"%sql\n\nselect * from f1_demo.results_external","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,25,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,18,"2",2,"2",1052,2,24967,1,"+0.745"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,16,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,12,"4",4,"4",1052,6,24969,1,"+46.466"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,10,"5",5,"5",1052,3,24970,1,"+52.047"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,8,"6",6,"6",1052,11,24971,1,"+59.090"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,6,"7",7,"7",1052,10,24972,1,"+66.004"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,4,"8",8,"8",1052,7,24973,1,"+67.100"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,2,"9",9,"9",1052,8,24974,1,"+85.692"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,1,"10",10,"10",1052,9,24975,1,"+86.713"],[51,8,"45","204.672","1:35.192",14,56,"5612761",7,0,"11",11,"11",1052,14,24976,1,"+88.864"],[51,841,"32","204.823","1:35.122",12,55,"\\N",99,0,"12",12,"12",1052,13,24977,11,"\\N"],[214,839,"33","204.548","1:35.250",16,55,"\\N",31,0,"13",13,"13",1052,15,24978,11,"\\N"],[3,847,"40","205.008","1:35.036",15,55,"\\N",63,0,"14",14,"14",1052,12,24979,11,"\\N"],[117,20,"26","203.871","1:35.566",20,55,"\\N",5,0,"15",15,"15",1052,16,24980,11,"\\N"],[210,854,"38","202.667","1:36.134",18,55,"\\N",47,0,"16",16,"16",1052,18,24981,11,"\\N"],[213,842,"48","207.069","1:34.090",5,52,"\\N",10,0,"17",17,"17",1052,5,24982,31,"\\N"],[3,849,"16","201.685","1:36.602",17,51,"\\N",6,0,"18",18,"18",1052,19,24983,31,"\\N"],[214,4,"31","202.816","1:36.063",9,32,"\\N",14,0,"\\N",19,"R",1052,17,24984,23,"\\N"],[210,853,"\\N","\\N","\\N",19,0,"\\N",9,0,"\\N",20,"R",1052,0,24985,3,"\\N"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205629771,"submitTime":1673205629746,"finishTime":1673205630445,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e7c6b5bd-1ee3-4d91-8e48-054e723b8ee2"},{"version":"CommandV1","origId":65578720055475,"guid":"ac6a3a12-b75b-49ee-a87b-93752e4d2ee8","subtype":"command","commandType":"auto","position":11.0,"command":"results_external_df = spark.read.format('delta').option('inferSchema', True).load('/mnt/formula1dljavi/demo/results_external')","commandVersion":36,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"results_external_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":"dbfs:/mnt/formula1dljavi/demo/results_external"}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205739595,"submitTime":1673205739310,"finishTime":1673205739768,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c9c89209-fe96-419a-bcd1-92cf7c7ba54f"},{"version":"CommandV1","origId":65578720055476,"guid":"ee1503c0-1b95-4080-b713-57fdd70ce94a","subtype":"command","commandType":"auto","position":12.0,"command":"display (results_external_df)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,25,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,18,"2",2,"2",1052,2,24967,1,"+0.745"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,16,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,12,"4",4,"4",1052,6,24969,1,"+46.466"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,10,"5",5,"5",1052,3,24970,1,"+52.047"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,8,"6",6,"6",1052,11,24971,1,"+59.090"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,6,"7",7,"7",1052,10,24972,1,"+66.004"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,4,"8",8,"8",1052,7,24973,1,"+67.100"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,2,"9",9,"9",1052,8,24974,1,"+85.692"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,1,"10",10,"10",1052,9,24975,1,"+86.713"],[51,8,"45","204.672","1:35.192",14,56,"5612761",7,0,"11",11,"11",1052,14,24976,1,"+88.864"],[51,841,"32","204.823","1:35.122",12,55,"\\N",99,0,"12",12,"12",1052,13,24977,11,"\\N"],[214,839,"33","204.548","1:35.250",16,55,"\\N",31,0,"13",13,"13",1052,15,24978,11,"\\N"],[3,847,"40","205.008","1:35.036",15,55,"\\N",63,0,"14",14,"14",1052,12,24979,11,"\\N"],[117,20,"26","203.871","1:35.566",20,55,"\\N",5,0,"15",15,"15",1052,16,24980,11,"\\N"],[210,854,"38","202.667","1:36.134",18,55,"\\N",47,0,"16",16,"16",1052,18,24981,11,"\\N"],[213,842,"48","207.069","1:34.090",5,52,"\\N",10,0,"17",17,"17",1052,5,24982,31,"\\N"],[3,849,"16","201.685","1:36.602",17,51,"\\N",6,0,"18",18,"18",1052,19,24983,31,"\\N"],[214,4,"31","202.816","1:36.063",9,32,"\\N",14,0,"\\N",19,"R",1052,17,24984,23,"\\N"],[210,853,"\\N","\\N","\\N",19,0,"\\N",9,0,"\\N",20,"R",1052,0,24985,3,"\\N"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205745618,"submitTime":1673205745592,"finishTime":1673205745874,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1054a21a-4081-429c-9d6d-19a39c967670"},{"version":"CommandV1","origId":65578720055477,"guid":"e429108a-5e82-4006-b3fb-8135e3a5142a","subtype":"command","commandType":"auto","position":13.0,"command":"results_df.write.format('delta').mode('overwrite').partitionBy('constructorId').saveAsTable('f1_demo.results_partitioned')","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205832469,"submitTime":1673205832443,"finishTime":1673205836718,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3c0152b3-2b6e-4b45-8293-a754e37bb2c6"},{"version":"CommandV1","origId":65578720055478,"guid":"0f2d32df-2428-454c-ac7f-a05536dd7126","subtype":"command","commandType":"auto","position":14.0,"command":"%sql\n\nselect * from f1_demo.results_partitioned","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,25,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,16,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,12,"4",4,"4",1052,6,24969,1,"+46.466"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,6,"7",7,"7",1052,10,24972,1,"+66.004"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,8,"6",6,"6",1052,11,24971,1,"+59.090"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,4,"8",8,"8",1052,7,24973,1,"+67.100"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,18,"2",2,"2",1052,2,24967,1,"+0.745"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,10,"5",5,"5",1052,3,24970,1,"+52.047"],[3,847,"40","205.008","1:35.036",15,55,"\\N",63,0,"14",14,"14",1052,12,24979,11,"\\N"],[3,849,"16","201.685","1:36.602",17,51,"\\N",6,0,"18",18,"18",1052,19,24983,31,"\\N"],[214,839,"33","204.548","1:35.250",16,55,"\\N",31,0,"13",13,"13",1052,15,24978,11,"\\N"],[214,4,"31","202.816","1:36.063",9,32,"\\N",14,0,"\\N",19,"R",1052,17,24984,23,"\\N"],[210,854,"38","202.667","1:36.134",18,55,"\\N",47,0,"16",16,"16",1052,18,24981,11,"\\N"],[210,853,"\\N","\\N","\\N",19,0,"\\N",9,0,"\\N",20,"R",1052,0,24985,3,"\\N"],[51,8,"45","204.672","1:35.192",14,56,"5612761",7,0,"11",11,"11",1052,14,24976,1,"+88.864"],[51,841,"32","204.823","1:35.122",12,55,"\\N",99,0,"12",12,"12",1052,13,24977,11,"\\N"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,1,"10",10,"10",1052,9,24975,1,"+86.713"],[117,20,"26","203.871","1:35.566",20,55,"\\N",5,0,"15",15,"15",1052,16,24980,11,"\\N"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,2,"9",9,"9",1052,8,24974,1,"+85.692"],[213,842,"48","207.069","1:34.090",5,52,"\\N",10,0,"17",17,"17",1052,5,24982,31,"\\N"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205854103,"submitTime":1673205854078,"finishTime":1673205855140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bda80f17-ffef-48e8-916b-cbfac278b920"},{"version":"CommandV1","origId":65578720055479,"guid":"1a8cbd93-f8a1-4ea6-a425-143ac6e36534","subtype":"command","commandType":"auto","position":15.0,"command":" %sql\n \n show PARTITIONS f1_demo.results_partitioned","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1],[3],[6],[9],[51],[131],[117],[214],[210],[213]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673205879701,"submitTime":1673205879676,"finishTime":1673205880780,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"10cf7812-dc68-44e9-a5bc-1623e8cc5339"},{"version":"CommandV1","origId":65578720055480,"guid":"6690a0a7-fe2d-49c3-83c3-50370182d047","subtype":"command","commandType":"auto","position":16.0,"command":"%sql\n\n\nupdate f1_demo.results_partitioned\nset points = 11-position\nwhere position <= 10\n\n","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[10]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206070494,"submitTime":1673206070467,"finishTime":1673206073901,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"14ac36eb-3042-4eb8-9eab-c88ecaa3de28"},{"version":"CommandV1","origId":65578720055481,"guid":"5a653db4-53bf-4ef6-8246-ab72223f6466","subtype":"command","commandType":"auto","position":17.0,"command":"%sql \n\nselect * from f1_demo.results_partitioned","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,10,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,8,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,7,"4",4,"4",1052,6,24969,1,"+46.466"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,4,"7",7,"7",1052,10,24972,1,"+66.004"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,5,"6",6,"6",1052,11,24971,1,"+59.090"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,3,"8",8,"8",1052,7,24973,1,"+67.100"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,9,"2",2,"2",1052,2,24967,1,"+0.745"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,6,"5",5,"5",1052,3,24970,1,"+52.047"],[3,847,"40","205.008","1:35.036",15,55,"\\N",63,0,"14",14,"14",1052,12,24979,11,"\\N"],[3,849,"16","201.685","1:36.602",17,51,"\\N",6,0,"18",18,"18",1052,19,24983,31,"\\N"],[214,839,"33","204.548","1:35.250",16,55,"\\N",31,0,"13",13,"13",1052,15,24978,11,"\\N"],[214,4,"31","202.816","1:36.063",9,32,"\\N",14,0,"\\N",19,"R",1052,17,24984,23,"\\N"],[210,854,"38","202.667","1:36.134",18,55,"\\N",47,0,"16",16,"16",1052,18,24981,11,"\\N"],[210,853,"\\N","\\N","\\N",19,0,"\\N",9,0,"\\N",20,"R",1052,0,24985,3,"\\N"],[51,8,"45","204.672","1:35.192",14,56,"5612761",7,0,"11",11,"11",1052,14,24976,1,"+88.864"],[51,841,"32","204.823","1:35.122",12,55,"\\N",99,0,"12",12,"12",1052,13,24977,11,"\\N"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,1,"10",10,"10",1052,9,24975,1,"+86.713"],[117,20,"26","203.871","1:35.566",20,55,"\\N",5,0,"15",15,"15",1052,16,24980,11,"\\N"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,2,"9",9,"9",1052,8,24974,1,"+85.692"],[213,842,"48","207.069","1:34.090",5,52,"\\N",10,0,"17",17,"17",1052,5,24982,31,"\\N"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206081969,"submitTime":1673206081944,"finishTime":1673206082810,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d492d526-dc07-42b0-94c5-adbd92ea2472"},{"version":"CommandV1","origId":65578720055482,"guid":"ff91090b-bafe-41a5-a59e-dee6300d2844","subtype":"command","commandType":"auto","position":18.0,"command":"from delta.tables import *\nfrom pyspark.sql.functions import *\n\n\n","commandVersion":32,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206138587,"submitTime":1673206138305,"finishTime":1673206138686,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c855fa6a-3bd1-4ed1-8dde-89f0e52009d1"},{"version":"CommandV1","origId":65578720055483,"guid":"c01a75f4-a722-4586-9b2a-a5e842f85343","subtype":"command","commandType":"auto","position":19.0,"command":"deltaTable = DeltaTable.forPath(spark, '/mnt/formula1dljavi/demo/results_managed')","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206215923,"submitTime":1673206215899,"finishTime":1673206216170,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e52778d4-3d48-43aa-91ee-0e2d6ee14dd2"},{"version":"CommandV1","origId":65578720055484,"guid":"cb9e4b44-a752-42b4-a980-25b5ea907e0d","subtype":"command","commandType":"auto","position":20.0,"command":"deltaTable.update('position <= 10 ', {'points' : '21 - position '})","commandVersion":24,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206282076,"submitTime":1673206281787,"finishTime":1673206284549,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d63af0a9-2fcc-4015-b6f5-1adddd3236dc"},{"version":"CommandV1","origId":65578720055485,"guid":"708ee20e-d0bb-41e9-80eb-5c48836ff153","subtype":"command","commandType":"auto","position":21.0,"command":"%sql\n\nselect * from f1_demo.results_managed","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,20,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,19,"2",2,"2",1052,2,24967,1,"+0.745"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,18,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,17,"4",4,"4",1052,6,24969,1,"+46.466"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,16,"5",5,"5",1052,3,24970,1,"+52.047"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,15,"6",6,"6",1052,11,24971,1,"+59.090"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,14,"7",7,"7",1052,10,24972,1,"+66.004"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,13,"8",8,"8",1052,7,24973,1,"+67.100"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,12,"9",9,"9",1052,8,24974,1,"+85.692"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,11,"10",10,"10",1052,9,24975,1,"+86.713"],[214,4,"31","202.816","1:36.063",9,32,"\\N",14,0,"\\N",19,"R",1052,17,24984,23,"\\N"],[210,853,"\\N","\\N","\\N",19,0,"\\N",9,0,"\\N",20,"R",1052,0,24985,3,"\\N"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206383713,"submitTime":1673206383685,"finishTime":1673206384353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",12]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"40bdd613-6305-42a6-944a-7772b6f9b6fd"},{"version":"CommandV1","origId":65578720055486,"guid":"a0f831bf-a5bb-43fe-8f1b-716ee485109f","subtype":"command","commandType":"auto","position":22.0,"command":"%sql\n\n\ndelete from f1_demo.results_managed where position >10","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[8]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206374025,"submitTime":1673206373984,"finishTime":1673206376845,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"808f0ad0-047d-4241-85d7-5f00d8ebf918"},{"version":"CommandV1","origId":65578720055487,"guid":"53d5db64-6361-4a58-b540-c64daf8ae8cf","subtype":"command","commandType":"auto","position":23.0,"command":"deltaTable = DeltaTable.forPath(spark, '/mnt/formula1dljavi/demo/results_managed')","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206424500,"submitTime":1673206424201,"finishTime":1673206424797,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e7bc33f6-8855-41eb-9f84-e66c015e5a40"},{"version":"CommandV1","origId":65578720055488,"guid":"487c19b5-047d-4d52-a15b-a8ceb4a9c8fa","subtype":"command","commandType":"auto","position":24.0,"command":"deltaTable.delete('points = 0' )","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206475618,"submitTime":1673206475594,"finishTime":1673206477370,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9839438f-334f-4154-9146-d04b6bcbeae5"},{"version":"CommandV1","origId":65578720055489,"guid":"1029462e-b8cf-4073-b0fc-b164eff3f64c","subtype":"command","commandType":"auto","position":25.0,"command":"%sql\n\nselect * from f1_demo.results_managed","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[131,1,"44","207.235","1:34.015",2,56,"5523897",44,20,"1",1,"1",1052,4,24966,1,"1:32:03.897"],[9,830,"41","208.984","1:33.228",1,56,"5524642",33,19,"2",2,"2",1052,2,24967,1,"+0.745"],[131,822,"56","211.566","1:32.090",3,56,"5561280",77,18,"3",3,"3",1052,1,24968,1,"+37.383"],[1,846,"38","206.398","1:34.396",7,56,"5570363",4,17,"4",4,"4",1052,6,24969,1,"+46.466"],[9,815,"44","207.334","1:33.970",0,56,"5575944",11,16,"5",5,"5",1052,3,24970,1,"+52.047"],[6,844,"39","205.112","1:34.988",4,56,"5582987",16,15,"6",6,"6",1052,11,24971,1,"+59.090"],[1,817,"36","205.233","1:34.932",6,56,"5589901",3,14,"7",7,"7",1052,10,24972,1,"+66.004"],[6,832,"48","206.151","1:34.509",8,56,"5590997",55,13,"8",8,"8",1052,7,24973,1,"+67.100"],[213,852,"38","205.603","1:34.761",13,56,"5609589",22,12,"9",9,"9",1052,8,24974,1,"+85.692"],[117,840,"31","205.378","1:34.865",10,56,"5610610",18,11,"10",10,"10",1052,9,24975,1,"+86.713"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"constructorId","type":"\"long\"","metadata":"{}"},{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"fastestLap","type":"\"string\"","metadata":"{}"},{"name":"fastestLapSpeed","type":"\"string\"","metadata":"{}"},{"name":"fastestLapTime","type":"\"string\"","metadata":"{}"},{"name":"grid","type":"\"long\"","metadata":"{}"},{"name":"laps","type":"\"long\"","metadata":"{}"},{"name":"milliseconds","type":"\"string\"","metadata":"{}"},{"name":"number","type":"\"long\"","metadata":"{}"},{"name":"points","type":"\"long\"","metadata":"{}"},{"name":"position","type":"\"string\"","metadata":"{}"},{"name":"positionOrder","type":"\"long\"","metadata":"{}"},{"name":"positionText","type":"\"string\"","metadata":"{}"},{"name":"raceId","type":"\"long\"","metadata":"{}"},{"name":"rank","type":"\"long\"","metadata":"{}"},{"name":"resultId","type":"\"long\"","metadata":"{}"},{"name":"statusId","type":"\"long\"","metadata":"{}"},{"name":"time","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"constructorId","nullable":true,"type":"long"},{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"fastestLap","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapSpeed","nullable":true,"type":"string"},{"metadata":{},"name":"fastestLapTime","nullable":true,"type":"string"},{"metadata":{},"name":"grid","nullable":true,"type":"long"},{"metadata":{},"name":"laps","nullable":true,"type":"long"},{"metadata":{},"name":"milliseconds","nullable":true,"type":"string"},{"metadata":{},"name":"number","nullable":true,"type":"long"},{"metadata":{},"name":"points","nullable":true,"type":"long"},{"metadata":{},"name":"position","nullable":true,"type":"string"},{"metadata":{},"name":"positionOrder","nullable":true,"type":"long"},{"metadata":{},"name":"positionText","nullable":true,"type":"string"},{"metadata":{},"name":"raceId","nullable":true,"type":"long"},{"metadata":{},"name":"rank","nullable":true,"type":"long"},{"metadata":{},"name":"resultId","nullable":true,"type":"long"},{"metadata":{},"name":"statusId","nullable":true,"type":"long"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206484423,"submitTime":1673206484399,"finishTime":1673206484978,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"004c6058-cd10-4b69-8d6b-615205e5e48c"},{"version":"CommandV1","origId":65578720055490,"guid":"538d8d66-2c6c-4455-94be-93396d75237b","subtype":"command","commandType":"auto","position":26.0,"command":"driver_day1_df= spark.read.option('inferSchema', True).json('/mnt/formula1dljavi/raw/2021-03-28/drivers.json')\\\n.filter(\"driverId <= 10\")\\\n.select ('driverId', 'dob', \"name.forename\", \"name.surname\")","commandVersion":48,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"driver_day1_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"dob","nullable":true,"type":"string"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206892161,"submitTime":1673206892136,"finishTime":1673206892515,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1f824391-a8f9-44e2-ba7b-bd5ae1fc38fc"},{"version":"CommandV1","origId":65578720055491,"guid":"a733a0ac-57df-4065-bca1-26c4ef0e312a","subtype":"command","commandType":"auto","position":2.5,"command":"results_df.write.format('parquet').mode('overwrite').saveAsTable('f1_demo.results_managed_parquet')","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206539051,"submitTime":1673206539027,"finishTime":1673206540242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a2b3ec92-4d26-4189-8e22-a4d1c0e4a2b4"},{"version":"CommandV1","origId":65578720055492,"guid":"deb1c888-3799-464e-9d22-bccf98322412","subtype":"command","commandType":"auto","position":2.75,"command":"%sql\n\ndrop table f1_demo.results_managed_parquet","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206623054,"submitTime":1673206623029,"finishTime":1673206624129,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a75b0d94-94e0-4b75-b966-8b9877c44506"},{"version":"CommandV1","origId":65578720055494,"guid":"3a14af78-eb33-4d9f-a45b-01364be81ce5","subtype":"command","commandType":"auto","position":27.0,"command":"display(driver_day1_df)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,"1985-01-07","Lewis","Hamilton"],[2,"1977-05-10","Nick","Heidfeld"],[3,"1985-06-27","Nico","Rosberg"],[4,"1981-07-29","Fernando","Alonso"],[5,"1981-10-19","Heikki","Kovalainen"],[6,"1985-01-11","Kazuki","Nakajima"],[7,"1979-02-28","Sébastien","Bourdais"],[8,"1979-10-17","Kimi","Räikkönen"],[9,"1984-12-07","Robert","Kubica"],[10,"1982-03-18","Timo","Glock"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"dob","type":"\"string\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673206893971,"submitTime":1673206893946,"finishTime":1673206894218,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c3030970-97a2-4c40-9d57-80ecd2d1b260"},{"version":"CommandV1","origId":65578720055495,"guid":"41a0e2ee-637f-4cad-865e-bdf2b28f1bd8","subtype":"command","commandType":"auto","position":28.0,"command":"driver_day2_df= spark.read.option('inferSchema', True).json('/mnt/formula1dljavi/raw/2021-03-28/drivers.json')\\\n.filter(\"driverId  between 6 and 15\")\\\n.select ('driverId', 'dob', upper(\"name.forename\").alias('forename'), upper(\"name.surname\").alias('surname'))","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"driver_day2_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"dob","nullable":true,"type":"string"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207955306,"submitTime":1673207955282,"finishTime":1673207955872,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"22d8a2bc-4118-4c82-a00d-ad06d5973080"},{"version":"CommandV1","origId":65578720055496,"guid":"3c6412e5-5dc4-421b-9865-01c0959b5865","subtype":"command","commandType":"auto","position":29.0,"command":"display (driver_day2_df)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS"],[8,"1979-10-17","KIMI","RÄIKKÖNEN"],[9,"1984-12-07","ROBERT","KUBICA"],[10,"1982-03-18","TIMO","GLOCK"],[11,"1977-01-28","TAKUMA","SATO"],[12,"1985-07-25","NELSON","PIQUET JR."],[13,"1981-04-25","FELIPE","MASSA"],[14,"1971-03-27","DAVID","COULTHARD"],[15,"1974-07-13","JARNO","TRULLI"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"dob","type":"\"string\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207959877,"submitTime":1673207959854,"finishTime":1673207959977,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"29278a7e-455b-459d-adb8-829697de4bb2"},{"version":"CommandV1","origId":65578720055497,"guid":"a1e9055d-02eb-4778-a94a-5b3deb509019","subtype":"command","commandType":"auto","position":30.0,"command":"driver_day3_df= spark.read.option('inferSchema', True).json('/mnt/formula1dljavi/raw/2021-03-28/drivers.json')\\\n.filter(\"driverId  between 1 and 5  or driverId between 16 and 20\")\\\n.select ('driverId', 'dob', upper(\"name.forename\").alias('forename'), upper(\"name.surname\").alias('surname'))","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"driver_day3_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"dob","nullable":true,"type":"string"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207964108,"submitTime":1673207964083,"finishTime":1673207964382,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0c1377b3-e0f0-4cab-9ba7-aa1227ba1bc9"},{"version":"CommandV1","origId":65578720055498,"guid":"d9b689a8-82e7-4103-ae4f-4b391ac611ea","subtype":"command","commandType":"auto","position":31.0,"command":"display(driver_day3_df)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,"1985-01-07","LEWIS","HAMILTON"],[2,"1977-05-10","NICK","HEIDFELD"],[3,"1985-06-27","NICO","ROSBERG"],[4,"1981-07-29","FERNANDO","ALONSO"],[5,"1981-10-19","HEIKKI","KOVALAINEN"],[16,"1983-01-11","ADRIAN","SUTIL"],[17,"1976-08-27","MARK","WEBBER"],[18,"1980-01-19","JENSON","BUTTON"],[19,"1979-04-18","ANTHONY","DAVIDSON"],[20,"1987-07-03","SEBASTIAN","VETTEL"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"dob","type":"\"string\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207966512,"submitTime":1673207966488,"finishTime":1673207966685,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5b5f7e81-d1b2-406c-ac75-99dd84ce7c12"},{"version":"CommandV1","origId":65578720055499,"guid":"5280ed1d-86b1-4fed-8a1f-f6d6c7ccbce4","subtype":"command","commandType":"auto","position":32.0,"command":"driver_day3_df.createOrReplaceTempView('drivers_day3')","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207969811,"submitTime":1673207969787,"finishTime":1673207969888,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"851a237c-a7f3-4ade-b8e7-8a5d30622861"},{"version":"CommandV1","origId":65578720055500,"guid":"ca91ce53-e82d-423e-ad17-6836b7201aaf","subtype":"command","commandType":"auto","position":26.5,"command":"driver_day1_df.createOrReplaceTempView('drivers_day1')","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207158938,"submitTime":1673207158913,"finishTime":1673207159005,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ae670bb1-6a1e-4208-93d4-f06a0f579be1"},{"version":"CommandV1","origId":65578720055502,"guid":"78d29459-31f4-436d-aed8-2cb548e2d95b","subtype":"command","commandType":"auto","position":28.5,"command":"driver_day2_df.createOrReplaceTempView('drivers_day2')","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207957558,"submitTime":1673207957533,"finishTime":1673207957674,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9c9f2494-20f3-4594-a994-afe69a4be0fe"},{"version":"CommandV1","origId":65578720055503,"guid":"0c758706-3000-40f9-b09b-ba61671a8286","subtype":"command","commandType":"auto","position":33.0,"command":"%sql\n\nCREATE TABLE IF NOT EXISTS f1_demo.drivers_merge(\ndriverId INT, \ndob DATE,\nforename STRING,\nsurname STRING,\ncreatedDate DATE,\nupdatedDate DATE\n)\nUSING DELTA ","commandVersion":44,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207741431,"submitTime":1673207741104,"finishTime":1673207743947,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"17df6c7e-d5b3-47b9-9587-1d6c0714c41d"},{"version":"CommandV1","origId":65578720055504,"guid":"7db761f4-7ccc-441f-bd16-0e26c8704a2c","subtype":"command","commandType":"auto","position":34.0,"command":"%sql\n\nMERGE INTO f1_demo.drivers_merge a\nUSING drivers_day1 b\non a.driverId = b.driverId\nWHEN MATCHED THEN\n  UPDATE set a.dob = b.dob,\n  a.forename = b.forename,\n  a.surname = b.surname,\n  a.updatedDate =  CURRENT_TIMESTAMP\nWHEN NOT MATCHED THEN\n  insert (driverId, dob, forename, surname, createdDate) values (b.driverId, b.dob, b.forename, b.surname, CURRENT_TIMESTAMP)  ","commandVersion":110,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[10,0,0,10]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"},{"name":"num_updated_rows","type":"\"long\"","metadata":"{}"},{"name":"num_deleted_rows","type":"\"long\"","metadata":"{}"},{"name":"num_inserted_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_updated_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_deleted_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_inserted_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207777810,"submitTime":1673207777786,"finishTime":1673207781588,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"afcf385d-09e1-4905-ac45-379b239f2224"},{"version":"CommandV1","origId":65578720055505,"guid":"e4fe8999-a7a7-42d4-81f9-f2c0ca629e89","subtype":"command","commandType":"auto","position":35.0,"command":"%sql\n\nSELECT * FROM  f1_demo.drivers_merge","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA","2023-01-08","2023-01-08"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS","2023-01-08","2023-01-08"],[8,"1979-10-17","KIMI","RÄIKKÖNEN","2023-01-08","2023-01-08"],[9,"1984-12-07","ROBERT","KUBICA","2023-01-08","2023-01-08"],[10,"1982-03-18","TIMO","GLOCK","2023-01-08","2023-01-08"],[11,"1977-01-28","TAKUMA","SATO","2023-01-08",null],[12,"1985-07-25","NELSON","PIQUET JR.","2023-01-08",null],[13,"1981-04-25","FELIPE","MASSA","2023-01-08",null],[14,"1971-03-27","DAVID","COULTHARD","2023-01-08",null],[15,"1974-07-13","JARNO","TRULLI","2023-01-08",null],[1,"1985-01-07","Lewis","Hamilton","2023-01-08",null],[2,"1977-05-10","Nick","Heidfeld","2023-01-08",null],[3,"1985-06-27","Nico","Rosberg","2023-01-08",null],[4,"1981-07-29","Fernando","Alonso","2023-01-08",null],[5,"1981-10-19","Heikki","Kovalainen","2023-01-08",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"dob","type":"\"date\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"},{"name":"createdDate","type":"\"date\"","metadata":"{}"},{"name":"updatedDate","type":"\"date\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207986296,"submitTime":1673207986272,"finishTime":1673207987011,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",15]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fb115cac-85fa-4218-b49e-29e02df134a2"},{"version":"CommandV1","origId":65578720055506,"guid":"e561b9ed-4e36-4279-9833-a41fbbf286fc","subtype":"command","commandType":"auto","position":36.0,"command":"%sql\n\nMERGE INTO f1_demo.drivers_merge a\nUSING drivers_day2 b\non a.driverId = b.driverId\nWHEN MATCHED THEN\n  UPDATE set a.dob = b.dob,\n  a.forename = b.forename,\n  a.surname = b.surname,\n  a.updatedDate =  CURRENT_TIMESTAMP\nWHEN NOT MATCHED THEN\n  insert (driverId, dob, forename, surname, createdDate) values (b.driverId, b.dob, b.forename, b.surname, CURRENT_TIMESTAMP)  ","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[10,5,0,5]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"},{"name":"num_updated_rows","type":"\"long\"","metadata":"{}"},{"name":"num_deleted_rows","type":"\"long\"","metadata":"{}"},{"name":"num_inserted_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_updated_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_deleted_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_inserted_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207976692,"submitTime":1673207976668,"finishTime":1673207980304,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"45de329d-d4fb-4cda-b661-2c4372ba1a42"},{"version":"CommandV1","origId":65578720055507,"guid":"c104b7ba-156b-4acd-85e6-8e1ec9fcc099","subtype":"command","commandType":"auto","position":37.0,"command":"%sql \n\nselect * from drivers_day2","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS"],[8,"1979-10-17","KIMI","RÄIKKÖNEN"],[9,"1984-12-07","ROBERT","KUBICA"],[10,"1982-03-18","TIMO","GLOCK"],[11,"1977-01-28","TAKUMA","SATO"],[12,"1985-07-25","NELSON","PIQUET JR."],[13,"1981-04-25","FELIPE","MASSA"],[14,"1971-03-27","DAVID","COULTHARD"],[15,"1974-07-13","JARNO","TRULLI"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"long\"","metadata":"{}"},{"name":"dob","type":"\"string\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surnmae","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"long"},{"metadata":{},"name":"dob","nullable":true,"type":"string"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surnmae","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673207937140,"submitTime":1673207937116,"finishTime":1673207937353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0c33fc99-26b5-48d7-b1bd-356c0b9342fe"},{"version":"CommandV1","origId":65578720055508,"guid":"494243fe-6497-4b47-bd8f-0f715f4d895c","subtype":"command","commandType":"auto","position":38.0,"command":"from delta.tables import *\n\ndeltaTable  = DeltaTable.forPath(spark, '/mnt/formula1dljavi/demo/drivers_merge')\n\n \ndeltaTable.alias('a') \\\n  .merge(\n    driver_day3_df.alias('b'),\n    'a.driverId = b.driverId'\n  ) \\\n  .whenMatchedUpdate(set =\n    {\n      \"dob\": \"b.dob\",\n      \"forename\": \"b.forename\",\n      \"surname\": \"b.surname\",\n      \"a.updatedDate\": \"current_timestamp()\"\n    }\n  ) \\\n  .whenNotMatchedInsert(values =\n    {\n      \"driverId\": \"b.driverId\",\n      \"dob\": \"b.dob\",\n      \"forename\": \"b.forename\",\n      \"surname\": \"b.surname\",\n      \"createdDate\": \"current_timestamp()\"\n    }\n  ) \\\n  .execute()","commandVersion":69,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673208537081,"submitTime":1673208537056,"finishTime":1673208540697,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8a617b3a-2c05-4e88-bd30-480159254cb3"},{"version":"CommandV1","origId":65578720055509,"guid":"78af3106-9528-4fdd-af56-aa4fa33a8e56","subtype":"command","commandType":"auto","position":37.5,"command":"from pyspark.sql.functions import current_timestamp","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673208480837,"submitTime":1673208480526,"finishTime":1673208480935,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8e32587a-d418-4570-a4c4-c1a22c23719a"},{"version":"CommandV1","origId":65578720055510,"guid":"0bd4b8df-e236-4fe1-96d4-f3f625c4c06c","subtype":"command","commandType":"auto","position":39.0,"command":"spark_df = spark.read.option('inferSchema', True).load('/mnt/formula1dljavi/demo/drivers_merge')","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"spark_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":"dbfs:/mnt/formula1dljavi/demo/drivers_merge"}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673208626252,"submitTime":1673208625970,"finishTime":1673208626398,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3653af43-9cec-4816-931a-feb3dfd9d8e0"},{"version":"CommandV1","origId":65578720055511,"guid":"56997f33-f5a6-457b-a3b3-72fb223d8067","subtype":"command","commandType":"auto","position":40.0,"command":"display(spark_df)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA","2023-01-08","2023-01-08"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS","2023-01-08","2023-01-08"],[8,"1979-10-17","KIMI","RÄIKKÖNEN","2023-01-08","2023-01-08"],[9,"1984-12-07","ROBERT","KUBICA","2023-01-08","2023-01-08"],[10,"1982-03-18","TIMO","GLOCK","2023-01-08","2023-01-08"],[11,"1977-01-28","TAKUMA","SATO","2023-01-08",null],[12,"1985-07-25","NELSON","PIQUET JR.","2023-01-08",null],[13,"1981-04-25","FELIPE","MASSA","2023-01-08",null],[14,"1971-03-27","DAVID","COULTHARD","2023-01-08",null],[15,"1974-07-13","JARNO","TRULLI","2023-01-08",null],[1,"1985-01-07","LEWIS","HAMILTON","2023-01-08","2023-01-08"],[2,"1977-05-10","NICK","HEIDFELD","2023-01-08","2023-01-08"],[3,"1985-06-27","NICO","ROSBERG","2023-01-08","2023-01-08"],[4,"1981-07-29","FERNANDO","ALONSO","2023-01-08","2023-01-08"],[5,"1981-10-19","HEIKKI","KOVALAINEN","2023-01-08","2023-01-08"],[16,"1983-01-11","ADRIAN","SUTIL","2023-01-08",null],[17,"1976-08-27","MARK","WEBBER","2023-01-08",null],[18,"1980-01-19","JENSON","BUTTON","2023-01-08",null],[19,"1979-04-18","ANTHONY","DAVIDSON","2023-01-08",null],[20,"1987-07-03","SEBASTIAN","VETTEL","2023-01-08",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"dob","type":"\"date\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"},{"name":"createdDate","type":"\"date\"","metadata":"{}"},{"name":"updatedDate","type":"\"date\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673208633539,"submitTime":1673208633517,"finishTime":1673208634108,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9f988864-66b4-46f5-ae44-594d0dae1cd4"},{"version":"CommandV1","origId":65578720055512,"guid":"5c2e00c5-9290-4df4-a95c-b70df72c435b","subtype":"command","commandType":"auto","position":41.0,"command":"%sql \n\ndesc history f1_demo.drivers_merge","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[3,"2023-01-08T20:08:59.000+0000","1122980043994194","javier.vasquez23@hotmail.com","MERGE",{"predicate":"(CAST(a.driverId AS BIGINT) = b.driverId)","matchedPredicates":"[{\"actionType\":\"update\"}]","notMatchedPredicates":"[{\"actionType\":\"insert\"}]"},null,["65578720055462"],"0102-150924-shnm99f9",2,"WriteSerializable",false,{"numTargetRowsCopied":"0","numTargetRowsDeleted":"0","numTargetFilesAdded":"1","executionTimeMs":"1608","numTargetRowsInserted":"5","scanTimeMs":"936","numTargetRowsUpdated":"5","numOutputRows":"10","numTargetChangeFilesAdded":"0","numSourceRows":"10","numTargetFilesRemoved":"1","rewriteTimeMs":"586"},null,"Databricks-Runtime/11.3.x-scala2.12"],[2,"2023-01-08T19:59:38.000+0000","1122980043994194","javier.vasquez23@hotmail.com","MERGE",{"predicate":"(CAST(a.driverId AS BIGINT) = b.driverId)","matchedPredicates":"[{\"actionType\":\"update\"}]","notMatchedPredicates":"[{\"actionType\":\"insert\"}]"},null,["65578720055462"],"0102-150924-shnm99f9",1,"WriteSerializable",false,{"numTargetRowsCopied":"5","numTargetRowsDeleted":"0","numTargetFilesAdded":"2","executionTimeMs":"2026","numTargetRowsInserted":"5","scanTimeMs":"1231","numTargetRowsUpdated":"5","numOutputRows":"15","numTargetChangeFilesAdded":"0","numSourceRows":"10","numTargetFilesRemoved":"1","rewriteTimeMs":"592"},null,"Databricks-Runtime/11.3.x-scala2.12"],[1,"2023-01-08T19:56:20.000+0000","1122980043994194","javier.vasquez23@hotmail.com","MERGE",{"predicate":"(CAST(a.driverId AS BIGINT) = b.driverId)","matchedPredicates":"[{\"actionType\":\"update\"}]","notMatchedPredicates":"[{\"actionType\":\"insert\"}]"},null,["65578720055462"],"0102-150924-shnm99f9",0,"WriteSerializable",false,{"numTargetRowsCopied":"0","numTargetRowsDeleted":"0","numTargetFilesAdded":"1","executionTimeMs":"1877","numTargetRowsInserted":"10","scanTimeMs":"1290","numTargetRowsUpdated":"0","numOutputRows":"10","numTargetChangeFilesAdded":"0","numSourceRows":"10","numTargetFilesRemoved":"0","rewriteTimeMs":"452"},null,"Databricks-Runtime/11.3.x-scala2.12"],[0,"2023-01-08T19:55:42.000+0000","1122980043994194","javier.vasquez23@hotmail.com","CREATE TABLE",{"isManaged":"true","description":null,"partitionBy":"[]","properties":"{}"},null,["65578720055462"],"0102-150924-shnm99f9",null,"WriteSerializable",true,{},null,"Databricks-Runtime/11.3.x-scala2.12"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"version","type":"\"long\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"},{"name":"userId","type":"\"string\"","metadata":"{}"},{"name":"userName","type":"\"string\"","metadata":"{}"},{"name":"operation","type":"\"string\"","metadata":"{}"},{"name":"operationParameters","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"job","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"jobId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"runId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobOwnerId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"triggerType\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"notebook","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"notebookId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"clusterId","type":"\"string\"","metadata":"{}"},{"name":"readVersion","type":"\"long\"","metadata":"{}"},{"name":"isolationLevel","type":"\"string\"","metadata":"{}"},{"name":"isBlindAppend","type":"\"boolean\"","metadata":"{}"},{"name":"operationMetrics","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"userMetadata","type":"\"string\"","metadata":"{}"},{"name":"engineInfo","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"version","nullable":true,"type":"long"},{"metadata":{},"name":"timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"userId","nullable":true,"type":"string"},{"metadata":{},"name":"userName","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"operationParameters","nullable":true,"type":{"keyType":"string","type":"map","valueContainsNull":true,"valueType":"string"}},{"metadata":{},"name":"job","nullable":true,"type":{"fields":[{"metadata":{},"name":"jobId","nullable":true,"type":"string"},{"metadata":{},"name":"jobName","nullable":true,"type":"string"},{"metadata":{},"name":"runId","nullable":true,"type":"string"},{"metadata":{},"name":"jobOwnerId","nullable":true,"type":"string"},{"metadata":{},"name":"triggerType","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"notebook","nullable":true,"type":{"fields":[{"metadata":{},"name":"notebookId","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"clusterId","nullable":true,"type":"string"},{"metadata":{},"name":"readVersion","nullable":true,"type":"long"},{"metadata":{},"name":"isolationLevel","nullable":true,"type":"string"},{"metadata":{},"name":"isBlindAppend","nullable":true,"type":"boolean"},{"metadata":{},"name":"operationMetrics","nullable":true,"type":{"keyType":"string","type":"map","valueContainsNull":true,"valueType":"string"}},{"metadata":{},"name":"userMetadata","nullable":true,"type":"string"},{"metadata":{},"name":"engineInfo","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673208802218,"submitTime":1673208801892,"finishTime":1673208803289,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",4]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9ec3a5d2-e7b4-4656-8e9e-278962636532"},{"version":"CommandV1","origId":65578720055513,"guid":"c8b1dade-15de-489f-9511-3958e5b02300","subtype":"command","commandType":"auto","position":42.0,"command":"%sql\n\nselect * from  f1_demo.drivers_merge version as of 1\n","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,"1985-01-07","Lewis","Hamilton","2023-01-08",null],[2,"1977-05-10","Nick","Heidfeld","2023-01-08",null],[3,"1985-06-27","Nico","Rosberg","2023-01-08",null],[4,"1981-07-29","Fernando","Alonso","2023-01-08",null],[5,"1981-10-19","Heikki","Kovalainen","2023-01-08",null],[6,"1985-01-11","Kazuki","Nakajima","2023-01-08",null],[7,"1979-02-28","Sébastien","Bourdais","2023-01-08",null],[8,"1979-10-17","Kimi","Räikkönen","2023-01-08",null],[9,"1984-12-07","Robert","Kubica","2023-01-08",null],[10,"1982-03-18","Timo","Glock","2023-01-08",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"dob","type":"\"date\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"},{"name":"createdDate","type":"\"date\"","metadata":"{}"},{"name":"updatedDate","type":"\"date\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673208868524,"submitTime":1673208868500,"finishTime":1673208869456,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",10]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bb17c9cd-1dbd-4306-ab6b-04ac2f95aa55"},{"version":"CommandV1","origId":65578720055514,"guid":"44ae2d1e-a089-4adf-b892-6fb069ae1f0c","subtype":"command","commandType":"auto","position":43.0,"command":"%sql\n\nselect * from  f1_demo.drivers_merge timestamp as of '2023-01-08T19:58:20.000+0000'","commandVersion":9,"state":"error","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"FileReadException: Error while reading file dbfs:/mnt/formula1dljavi/demo/drivers_merge/part-00000-7d0cb593-598c-441b-936b-9ce749a4e0fe-c000.snappy.parquet. A file referenced in the transaction log cannot be found. This occurs when data has been manually deleted from the file system rather than using the table `DELETE` statement. For more information, see https://docs.microsoft.com/azure/databricks/delta/delta-intro#frequently-asked-questions\nCaused by: FileNotFoundException: Operation failed: \"The specified path does not exist.\", 404, GET, https://formula1dljavi.dfs.core.windows.net/demo/drivers_merge/part-00000-7d0cb593-598c-441b-936b-9ce749a4e0fe-c000.snappy.parquet?timeout=90, PathNotFound, \"The specified path does not exist. RequestId:492eb931-901f-004d-459e-23b415000000 Time:2023-01-08T20:20:26.5421144Z\"","errorTraceType":"html","error":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 354.0 failed 4 times, most recent failure: Lost task 0.3 in stage 354.0 (TID 2321) (10.139.64.4 executor driver): com.databricks.sql.io.FileReadException: Error while reading file dbfs:/mnt/formula1dljavi/demo/drivers_merge/part-00000-7d0cb593-598c-441b-936b-9ce749a4e0fe-c000.snappy.parquet. A file referenced in the transaction log cannot be found. This occurs when data has been manually deleted from the file system rather than using the table `DELETE` statement. For more information, see https://docs.microsoft.com/azure/databricks/delta/delta-intro#frequently-asked-questions\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anon$2.logFileNameAndThrow(FileScanRDD.scala:626)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anon$2.getNext(FileScanRDD.scala:574)\n\tat org.apache.spark.util.NextIterator.hasNext(NextIterator.scala:73)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:719)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.$anonfun$hasNext$1(FileScanRDD.scala:437)\n\tat scala.runtime.java8.JFunction0$mcZ$sp.apply(JFunction0$mcZ$sp.java:23)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:432)\n\tat org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:1975)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:761)\n\tat org.apache.spark.sql.execution.collect.UnsafeRowBatchUtils$.encodeUnsafeRows(UnsafeRowBatchUtils.scala:80)\n\tat org.apache.spark.sql.execution.collect.Collector.$anonfun$processFunc$1(Collector.scala:186)\n\tat org.apache.spark.scheduler.ResultTask.$anonfun$runTask$3(ResultTask.scala:75)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.scheduler.ResultTask.$anonfun$runTask$1(ResultTask.scala:75)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:55)\n\tat org.apache.spark.scheduler.Task.doRunTask(Task.scala:169)\n\tat org.apache.spark.scheduler.Task.$anonfun$run$4(Task.scala:137)\n\tat com.databricks.unity.EmptyHandle$.runWithAndClose(UCSHandle.scala:104)\n\tat org.apache.spark.scheduler.Task.$anonfun$run$1(Task.scala:137)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$13(Executor.scala:902)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1696)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:905)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:760)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:750)\nCaused by: java.io.FileNotFoundException: Operation failed: \"The specified path does not exist.\", 404, GET, https://formula1dljavi.dfs.core.windows.net/demo/drivers_merge/part-00000-7d0cb593-598c-441b-936b-9ce749a4e0fe-c000.snappy.parquet?timeout=90, PathNotFound, \"The specified path does not exist. RequestId:492eb931-901f-004d-459e-23b415000000 Time:2023-01-08T20:20:26.5421144Z\"\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readRemote(AbfsInputStream.java:617)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readInternal(AbfsInputStream.java:566)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readOneBlock(AbfsInputStream.java:360)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.read(AbfsInputStream.java:298)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.read(AbfsInputStream.java:265)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:83)\n\tat com.databricks.spark.metrics.FSInputStreamWithMetrics.$anonfun$read$2(FileSystemWithMetrics.scala:214)\n\tat scala.runtime.java8.JFunction0$mcI$sp.apply(JFunction0$mcI$sp.java:23)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeMetric(FileSystemWithMetrics.scala:158)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeAndBytesMetric(FileSystemWithMetrics.scala:178)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.$anonfun$withTimeAndBytesReadMetric$1(FileSystemWithMetrics.scala:192)\n\tat scala.runtime.java8.JFunction0$mcI$sp.apply(JFunction0$mcI$sp.java:23)\n\tat com.databricks.spark.metrics.SamplerWithPeriod.sample(FileSystemWithMetrics.scala:85)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeAndBytesReadMetric(FileSystemWithMetrics.scala:192)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeAndBytesReadMetric$(FileSystemWithMetrics.scala:191)\n\tat com.databricks.spark.metrics.FSInputStreamWithMetrics.withTimeAndBytesReadMetric(FileSystemWithMetrics.scala:199)\n\tat com.databricks.spark.metrics.FSInputStreamWithMetrics.read(FileSystemWithMetrics.scala:213)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:83)\n\tat org.apache.parquet.bytes.BytesUtils.readIntLittleEndian(BytesUtils.java:83)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.readFooterBytesFromInputStream(CachingParquetFooterReader.java:135)\n\tat com.databricks.sql.io.parquet.CachingParquetFileReader$FooterByteReader.read(CachingParquetFileReader.java:374)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader$LegacyCache.read(CachingParquetFooterReader.java:338)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.lambda$readFooterFromStorage$0(CachingParquetFooterReader.java:286)\n\tat org.apache.spark.util.JavaFrameProfiler.record(JavaFrameProfiler.java:17)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.readFooterFromStorage(CachingParquetFooterReader.java:282)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.readFooter(CachingParquetFooterReader.java:204)\n\tat com.databricks.sql.io.parquet.CachingParquetFileReader.readFooter(CachingParquetFileReader.java:394)\n\tat org.apache.spark.sql.execution.datasources.parquet.SpecificParquetRecordReaderBase.prepare(SpecificParquetRecordReaderBase.java:157)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$2.apply(ParquetFileFormat.scala:496)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$2.apply(ParquetFileFormat.scala:350)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anon$2.getNext(FileScanRDD.scala:554)\n\t... 33 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:3312)\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:3244)\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:3235)\n\tat scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\n\tat scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:3235)\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1424)\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1424)\n\tat scala.Option.foreach(Option.scala:407)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1424)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3524)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:3462)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:3450)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:51)\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$runJob$1(DAGScheduler.scala:1169)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:80)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:1157)\n\tat org.apache.spark.SparkContext.runJobInternal(SparkContext.scala:2713)\n\tat org.apache.spark.sql.execution.collect.Collector.$anonfun$runSparkJobs$1(Collector.scala:312)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:80)\n\tat org.apache.spark.sql.execution.collect.Collector.runSparkJobs(Collector.scala:271)\n\tat org.apache.spark.sql.execution.collect.Collector.collect(Collector.scala:322)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:105)\n\tat org.apache.spark.sql.execution.collect.Collector$.collect(Collector.scala:112)\n\tat org.apache.spark.sql.execution.qrc.InternalRowFormat$.collect(cachedSparkResults.scala:115)\n\tat org.apache.spark.sql.execution.qrc.InternalRowFormat$.collect(cachedSparkResults.scala:104)\n\tat org.apache.spark.sql.execution.qrc.InternalRowFormat$.collect(cachedSparkResults.scala:88)\n\tat org.apache.spark.sql.execution.qrc.ResultCacheManager.$anonfun$computeResult$1(ResultCacheManager.scala:527)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:80)\n\tat org.apache.spark.sql.execution.qrc.ResultCacheManager.collectResult$1(ResultCacheManager.scala:519)\n\tat org.apache.spark.sql.execution.qrc.ResultCacheManager.computeResult(ResultCacheManager.scala:539)\n\tat org.apache.spark.sql.execution.qrc.ResultCacheManager.$anonfun$getOrComputeResultInternal$1(ResultCacheManager.scala:396)\n\tat scala.Option.getOrElse(Option.scala:189)\n\tat org.apache.spark.sql.execution.qrc.ResultCacheManager.getOrComputeResultInternal(ResultCacheManager.scala:390)\n\tat org.apache.spark.sql.execution.qrc.ResultCacheManager.getOrComputeResult(ResultCacheManager.scala:292)\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$executeCollectResult$1(SparkPlan.scala:431)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:80)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollectResult(SparkPlan.scala:428)\n\tat org.apache.spark.sql.Dataset.collectResult(Dataset.scala:3424)\n\tat org.apache.spark.sql.Dataset.$anonfun$collectResult$1(Dataset.scala:3415)\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$3(Dataset.scala:4290)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:777)\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:4288)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$8(SQLExecution.scala:243)\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:392)\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withCustomExecutionEnv$1(SQLExecution.scala:188)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:985)\n\tat org.apache.spark.sql.execution.SQLExecution$.withCustomExecutionEnv(SQLExecution.scala:142)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:342)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:4288)\n\tat org.apache.spark.sql.Dataset.collectResult(Dataset.scala:3414)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation0(OutputAggregator.scala:267)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation(OutputAggregator.scala:101)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocalBase.generateTableResult(PythonDriverLocalBase.scala:720)\n\tat com.databricks.backend.daemon.driver.JupyterDriverLocal.computeListResultsItem(JupyterDriverLocal.scala:1332)\n\tat com.databricks.backend.daemon.driver.JupyterDriverLocal$JupyterEntryPoint.addCustomDisplayData(JupyterDriverLocal.scala:489)\n\tat sun.reflect.GeneratedMethodAccessor464.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)\n\tat py4j.Gateway.invoke(Gateway.java:306)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:195)\n\tat py4j.ClientServerConnection.run(ClientServerConnection.java:115)\n\tat java.lang.Thread.run(Thread.java:750)\nCaused by: com.databricks.sql.io.FileReadException: Error while reading file dbfs:/mnt/formula1dljavi/demo/drivers_merge/part-00000-7d0cb593-598c-441b-936b-9ce749a4e0fe-c000.snappy.parquet. A file referenced in the transaction log cannot be found. This occurs when data has been manually deleted from the file system rather than using the table `DELETE` statement. For more information, see https://docs.microsoft.com/azure/databricks/delta/delta-intro#frequently-asked-questions\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anon$2.logFileNameAndThrow(FileScanRDD.scala:626)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anon$2.getNext(FileScanRDD.scala:574)\n\tat org.apache.spark.util.NextIterator.hasNext(NextIterator.scala:73)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:719)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.$anonfun$hasNext$1(FileScanRDD.scala:437)\n\tat scala.runtime.java8.JFunction0$mcZ$sp.apply(JFunction0$mcZ$sp.java:23)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:432)\n\tat org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:1975)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:761)\n\tat org.apache.spark.sql.execution.collect.UnsafeRowBatchUtils$.encodeUnsafeRows(UnsafeRowBatchUtils.scala:80)\n\tat org.apache.spark.sql.execution.collect.Collector.$anonfun$processFunc$1(Collector.scala:186)\n\tat org.apache.spark.scheduler.ResultTask.$anonfun$runTask$3(ResultTask.scala:75)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.scheduler.ResultTask.$anonfun$runTask$1(ResultTask.scala:75)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:55)\n\tat org.apache.spark.scheduler.Task.doRunTask(Task.scala:169)\n\tat org.apache.spark.scheduler.Task.$anonfun$run$4(Task.scala:137)\n\tat com.databricks.unity.EmptyHandle$.runWithAndClose(UCSHandle.scala:104)\n\tat org.apache.spark.scheduler.Task.$anonfun$run$1(Task.scala:137)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$13(Executor.scala:902)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1696)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:905)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n\tat com.databricks.spark.util.ExecutorFrameProfiler$.record(ExecutorFrameProfiler.scala:110)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:760)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\nCaused by: java.io.FileNotFoundException: Operation failed: \"The specified path does not exist.\", 404, GET, https://formula1dljavi.dfs.core.windows.net/demo/drivers_merge/part-00000-7d0cb593-598c-441b-936b-9ce749a4e0fe-c000.snappy.parquet?timeout=90, PathNotFound, \"The specified path does not exist. RequestId:492eb931-901f-004d-459e-23b415000000 Time:2023-01-08T20:20:26.5421144Z\"\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readRemote(AbfsInputStream.java:617)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readInternal(AbfsInputStream.java:566)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readOneBlock(AbfsInputStream.java:360)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.read(AbfsInputStream.java:298)\n\tat shaded.databricks.azurebfs.org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.read(AbfsInputStream.java:265)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:83)\n\tat com.databricks.spark.metrics.FSInputStreamWithMetrics.$anonfun$read$2(FileSystemWithMetrics.scala:214)\n\tat scala.runtime.java8.JFunction0$mcI$sp.apply(JFunction0$mcI$sp.java:23)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeMetric(FileSystemWithMetrics.scala:158)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeAndBytesMetric(FileSystemWithMetrics.scala:178)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.$anonfun$withTimeAndBytesReadMetric$1(FileSystemWithMetrics.scala:192)\n\tat scala.runtime.java8.JFunction0$mcI$sp.apply(JFunction0$mcI$sp.java:23)\n\tat com.databricks.spark.metrics.SamplerWithPeriod.sample(FileSystemWithMetrics.scala:85)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeAndBytesReadMetric(FileSystemWithMetrics.scala:192)\n\tat com.databricks.spark.metrics.ExtendedTaskIOMetrics.withTimeAndBytesReadMetric$(FileSystemWithMetrics.scala:191)\n\tat com.databricks.spark.metrics.FSInputStreamWithMetrics.withTimeAndBytesReadMetric(FileSystemWithMetrics.scala:199)\n\tat com.databricks.spark.metrics.FSInputStreamWithMetrics.read(FileSystemWithMetrics.scala:213)\n\tat java.io.FilterInputStream.read(FilterInputStream.java:83)\n\tat org.apache.parquet.bytes.BytesUtils.readIntLittleEndian(BytesUtils.java:83)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.readFooterBytesFromInputStream(CachingParquetFooterReader.java:135)\n\tat com.databricks.sql.io.parquet.CachingParquetFileReader$FooterByteReader.read(CachingParquetFileReader.java:374)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader$LegacyCache.read(CachingParquetFooterReader.java:338)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.lambda$readFooterFromStorage$0(CachingParquetFooterReader.java:286)\n\tat org.apache.spark.util.JavaFrameProfiler.record(JavaFrameProfiler.java:17)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.readFooterFromStorage(CachingParquetFooterReader.java:282)\n\tat com.databricks.sql.io.parquet.CachingParquetFooterReader.readFooter(CachingParquetFooterReader.java:204)\n\tat com.databricks.sql.io.parquet.CachingParquetFileReader.readFooter(CachingParquetFileReader.java:394)\n\tat org.apache.spark.sql.execution.datasources.parquet.SpecificParquetRecordReaderBase.prepare(SpecificParquetRecordReaderBase.java:157)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$2.apply(ParquetFileFormat.scala:496)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$2.apply(ParquetFileFormat.scala:350)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anon$2.getNext(FileScanRDD.scala:554)\n\t... 33 more\n","errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209222103,"submitTime":1673209222103,"finishTime":1673209226694,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"66a8cf42-2d0d-4ddc-8917-a8d566344879"},{"version":"CommandV1","origId":65578720055515,"guid":"ed5a9a5c-52a6-4030-bf38-91215479b17b","subtype":"command","commandType":"auto","position":44.0,"command":"spark_df = spark.read.option('timestampAsOf', '2023-01-08T19:59:38.000+0000').load('/mnt/formula1dljavi/demo/drivers_merge')","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"spark_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":"dbfs:/mnt/formula1dljavi/demo/drivers_merge"}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209015441,"submitTime":1673209015405,"finishTime":1673209015708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a2d40b04-2284-4ee1-88b2-1df780534837"},{"version":"CommandV1","origId":65578720055516,"guid":"8b419f00-4eb1-4efa-9b12-ef1603fb0872","subtype":"command","commandType":"auto","position":45.0,"command":"display(spark_df)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA","2023-01-08","2023-01-08"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS","2023-01-08","2023-01-08"],[8,"1979-10-17","KIMI","RÄIKKÖNEN","2023-01-08","2023-01-08"],[9,"1984-12-07","ROBERT","KUBICA","2023-01-08","2023-01-08"],[10,"1982-03-18","TIMO","GLOCK","2023-01-08","2023-01-08"],[11,"1977-01-28","TAKUMA","SATO","2023-01-08",null],[12,"1985-07-25","NELSON","PIQUET JR.","2023-01-08",null],[13,"1981-04-25","FELIPE","MASSA","2023-01-08",null],[14,"1971-03-27","DAVID","COULTHARD","2023-01-08",null],[15,"1974-07-13","JARNO","TRULLI","2023-01-08",null],[1,"1985-01-07","Lewis","Hamilton","2023-01-08",null],[2,"1977-05-10","Nick","Heidfeld","2023-01-08",null],[3,"1985-06-27","Nico","Rosberg","2023-01-08",null],[4,"1981-07-29","Fernando","Alonso","2023-01-08",null],[5,"1981-10-19","Heikki","Kovalainen","2023-01-08",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"dob","type":"\"date\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"},{"name":"createdDate","type":"\"date\"","metadata":"{}"},{"name":"updatedDate","type":"\"date\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209023011,"submitTime":1673209022977,"finishTime":1673209023415,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",15]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"345b87a8-cf57-4590-a0b4-800ca8c38b40"},{"version":"CommandV1","origId":65578720055517,"guid":"c9c1ce00-ac51-4b43-a080-52077e6e08c3","subtype":"command","commandType":"auto","position":46.0,"command":"%sql\nSET spark.databricks.delta.retentionDurationCheck.enabled = false;\nVACUUM f1_demo.drivers_merge RETAIN 0 HOURS","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["dbfs:/mnt/formula1dljavi/demo/drivers_merge"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"path","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209214791,"submitTime":1673209214768,"finishTime":1673209225959,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"889bd803-f82a-4d6b-be4a-5bdd3a4a588c"},{"version":"CommandV1","origId":65578720055518,"guid":"40db08a0-1369-42b4-ba2e-d9674f4a20c4","subtype":"command","commandType":"auto","position":47.0,"command":"%sql \n\ndelete from f1_demo.drivers_merge where driverId = 1","commandVersion":16,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209346639,"submitTime":1673209346358,"finishTime":1673209348508,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"984de031-224a-49b7-82ea-1dc75169066b"},{"version":"CommandV1","origId":65578720055520,"guid":"e9cab65b-e723-4570-b041-935c469a4087","subtype":"command","commandType":"auto","position":48.0,"command":"%sql \nselect * from f1_demo.drivers_merge VERSION AS OF 3","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA","2023-01-08","2023-01-08"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS","2023-01-08","2023-01-08"],[8,"1979-10-17","KIMI","RÄIKKÖNEN","2023-01-08","2023-01-08"],[9,"1984-12-07","ROBERT","KUBICA","2023-01-08","2023-01-08"],[10,"1982-03-18","TIMO","GLOCK","2023-01-08","2023-01-08"],[11,"1977-01-28","TAKUMA","SATO","2023-01-08",null],[12,"1985-07-25","NELSON","PIQUET JR.","2023-01-08",null],[13,"1981-04-25","FELIPE","MASSA","2023-01-08",null],[14,"1971-03-27","DAVID","COULTHARD","2023-01-08",null],[15,"1974-07-13","JARNO","TRULLI","2023-01-08",null],[1,"1985-01-07","LEWIS","HAMILTON","2023-01-08","2023-01-08"],[2,"1977-05-10","NICK","HEIDFELD","2023-01-08","2023-01-08"],[3,"1985-06-27","NICO","ROSBERG","2023-01-08","2023-01-08"],[4,"1981-07-29","FERNANDO","ALONSO","2023-01-08","2023-01-08"],[5,"1981-10-19","HEIKKI","KOVALAINEN","2023-01-08","2023-01-08"],[16,"1983-01-11","ADRIAN","SUTIL","2023-01-08",null],[17,"1976-08-27","MARK","WEBBER","2023-01-08",null],[18,"1980-01-19","JENSON","BUTTON","2023-01-08",null],[19,"1979-04-18","ANTHONY","DAVIDSON","2023-01-08",null],[20,"1987-07-03","SEBASTIAN","VETTEL","2023-01-08",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"dob","type":"\"date\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"},{"name":"createdDate","type":"\"date\"","metadata":"{}"},{"name":"updatedDate","type":"\"date\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209394440,"submitTime":1673209394416,"finishTime":1673209394962,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a1ca6f42-643c-4e52-be20-2d5b136d70af"},{"version":"CommandV1","origId":65578720055521,"guid":"49e4be57-975f-4117-8c0d-4ecc772a012b","subtype":"command","commandType":"auto","position":49.0,"command":"%sql\n\nMERGE INTO f1_demo.drivers_merge a\nUSING f1_demo.drivers_merge VERSION AS OF 3 b\non a.driverId = b.driverId\nWHEN NOT MATCHED THEN \nINSERT *","commandVersion":35,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,0,0,1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"},{"name":"num_updated_rows","type":"\"long\"","metadata":"{}"},{"name":"num_deleted_rows","type":"\"long\"","metadata":"{}"},{"name":"num_inserted_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_updated_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_deleted_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_inserted_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209487934,"submitTime":1673209487594,"finishTime":1673209490897,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"83caf577-bbbf-4491-ab9d-3a63df9d65a2"},{"version":"CommandV1","origId":65578720055522,"guid":"d0cb1a97-4ab0-40ee-a021-d779af9ab019","subtype":"command","commandType":"auto","position":50.0,"command":"%sql\n\nselect * from f1_demo.drivers_merge","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[6,"1985-01-11","KAZUKI","NAKAJIMA","2023-01-08","2023-01-08"],[7,"1979-02-28","SÉBASTIEN","BOURDAIS","2023-01-08","2023-01-08"],[8,"1979-10-17","KIMI","RÄIKKÖNEN","2023-01-08","2023-01-08"],[9,"1984-12-07","ROBERT","KUBICA","2023-01-08","2023-01-08"],[10,"1982-03-18","TIMO","GLOCK","2023-01-08","2023-01-08"],[11,"1977-01-28","TAKUMA","SATO","2023-01-08",null],[12,"1985-07-25","NELSON","PIQUET JR.","2023-01-08",null],[13,"1981-04-25","FELIPE","MASSA","2023-01-08",null],[14,"1971-03-27","DAVID","COULTHARD","2023-01-08",null],[15,"1974-07-13","JARNO","TRULLI","2023-01-08",null],[2,"1977-05-10","NICK","HEIDFELD","2023-01-08","2023-01-08"],[3,"1985-06-27","NICO","ROSBERG","2023-01-08","2023-01-08"],[4,"1981-07-29","FERNANDO","ALONSO","2023-01-08","2023-01-08"],[5,"1981-10-19","HEIKKI","KOVALAINEN","2023-01-08","2023-01-08"],[16,"1983-01-11","ADRIAN","SUTIL","2023-01-08",null],[17,"1976-08-27","MARK","WEBBER","2023-01-08",null],[18,"1980-01-19","JENSON","BUTTON","2023-01-08",null],[19,"1979-04-18","ANTHONY","DAVIDSON","2023-01-08",null],[20,"1987-07-03","SEBASTIAN","VETTEL","2023-01-08",null],[1,"1985-01-07","LEWIS","HAMILTON","2023-01-08","2023-01-08"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"driverId","type":"\"integer\"","metadata":"{}"},{"name":"dob","type":"\"date\"","metadata":"{}"},{"name":"forename","type":"\"string\"","metadata":"{}"},{"name":"surname","type":"\"string\"","metadata":"{}"},{"name":"createdDate","type":"\"date\"","metadata":"{}"},{"name":"updatedDate","type":"\"date\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209503677,"submitTime":1673209503652,"finishTime":1673209504210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3cff5279-d97a-4921-8cbc-c2777a70875f"},{"version":"CommandV1","origId":65578720055523,"guid":"c07da805-98e3-455b-be10-5d471c4d7ea8","subtype":"command","commandType":"auto","position":51.0,"command":"%sql\n\nCREATE TABLE IF NOT EXISTS f1_demo.drivers_txn(\ndriverId INT, \ndob DATE,\nforename STRING,\nsurname STRING,\ncreatedDate DATE,\nupdatedDate DATE\n)\nUSING DELTA ","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209620266,"submitTime":1673209619968,"finishTime":1673209622629,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3206898a-9eae-4922-9a8d-f3f3f057122a"},{"version":"CommandV1","origId":65578720055524,"guid":"0e52096f-a600-46b8-834d-e7f149b6bd76","subtype":"command","commandType":"auto","position":52.0,"command":"%sql\ndesc HISTORY f1_demo.drivers_txn","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[0,"2023-01-08T20:27:00.000+0000","1122980043994194","javier.vasquez23@hotmail.com","CREATE TABLE",{"isManaged":"true","description":null,"partitionBy":"[]","properties":"{}"},null,["65578720055462"],"0102-150924-shnm99f9",null,"WriteSerializable",true,{},null,"Databricks-Runtime/11.3.x-scala2.12"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"version","type":"\"long\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"},{"name":"userId","type":"\"string\"","metadata":"{}"},{"name":"userName","type":"\"string\"","metadata":"{}"},{"name":"operation","type":"\"string\"","metadata":"{}"},{"name":"operationParameters","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"job","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"jobId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"runId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobOwnerId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"triggerType\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"notebook","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"notebookId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"clusterId","type":"\"string\"","metadata":"{}"},{"name":"readVersion","type":"\"long\"","metadata":"{}"},{"name":"isolationLevel","type":"\"string\"","metadata":"{}"},{"name":"isBlindAppend","type":"\"boolean\"","metadata":"{}"},{"name":"operationMetrics","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"userMetadata","type":"\"string\"","metadata":"{}"},{"name":"engineInfo","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"version","nullable":true,"type":"long"},{"metadata":{},"name":"timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"userId","nullable":true,"type":"string"},{"metadata":{},"name":"userName","nullable":true,"type":"string"},{"metadata":{},"name":"operation","nullable":true,"type":"string"},{"metadata":{},"name":"operationParameters","nullable":true,"type":{"keyType":"string","type":"map","valueContainsNull":true,"valueType":"string"}},{"metadata":{},"name":"job","nullable":true,"type":{"fields":[{"metadata":{},"name":"jobId","nullable":true,"type":"string"},{"metadata":{},"name":"jobName","nullable":true,"type":"string"},{"metadata":{},"name":"runId","nullable":true,"type":"string"},{"metadata":{},"name":"jobOwnerId","nullable":true,"type":"string"},{"metadata":{},"name":"triggerType","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"notebook","nullable":true,"type":{"fields":[{"metadata":{},"name":"notebookId","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"clusterId","nullable":true,"type":"string"},{"metadata":{},"name":"readVersion","nullable":true,"type":"long"},{"metadata":{},"name":"isolationLevel","nullable":true,"type":"string"},{"metadata":{},"name":"isBlindAppend","nullable":true,"type":"boolean"},{"metadata":{},"name":"operationMetrics","nullable":true,"type":{"keyType":"string","type":"map","valueContainsNull":true,"valueType":"string"}},{"metadata":{},"name":"userMetadata","nullable":true,"type":"string"},{"metadata":{},"name":"engineInfo","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209642265,"submitTime":1673209642243,"finishTime":1673209643054,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3ad39341-b659-49e7-9dbb-10d1e35169bc"},{"version":"CommandV1","origId":65578720055525,"guid":"ee866b6b-3192-458c-9e78-026c4f7e74c9","subtype":"command","commandType":"auto","position":53.0,"command":"%sql\n\nINSERT INTO  f1_demo.drivers_txn\nSELECT * FROM  f1_demo.drivers_merge where driverId = 1","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[1,1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"},{"name":"num_inserted_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"num_affected_rows","nullable":true,"type":"long"},{"metadata":{},"name":"num_inserted_rows","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673209712806,"submitTime":1673209712784,"finishTime":1673209715026,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"34d99cc1-d655-4a61-9a47-ef9d194028ff"},{"version":"CommandV1","origId":65578720055526,"guid":"6389357e-bcd9-43b1-87c0-1e9f02bab0d6","subtype":"command","commandType":"auto","position":54.0,"command":"%sql\n\nCREATE TABLE IF NOT EXISTS f1_demo.drivers_convert_to_delta(\ndriverId INT, \ndob DATE,\nforename STRING,\nsurname STRING,\ncreatedDate DATE,\nupdatedDate DATE\n)\nUSING PARQUET ","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673210199907,"submitTime":1673210199884,"finishTime":1673210200241,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"92c75ba8-47ed-4814-9d76-90f6cd0d837e"},{"version":"CommandV1","origId":65578720055527,"guid":"2d9ef6cb-ac73-4803-8af3-90b70e89386c","subtype":"command","commandType":"auto","position":55.0,"command":"%sql \n\ninsert into f1_demo.drivers_convert_to_delta\nselect * from f1_demo.drivers_merge","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673210220967,"submitTime":1673210220944,"finishTime":1673210221865,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"70a4c1fc-499d-481b-b8a7-180b1c6896e3"},{"version":"CommandV1","origId":65578720055528,"guid":"e5034809-1436-45be-8751-d7e2c36c2fde","subtype":"command","commandType":"auto","position":56.0,"command":"%sql\n\nCONVERT TO DELTA f1_demo.drivers_convert_to_delta","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673210254778,"submitTime":1673210254756,"finishTime":1673210258828,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"04424803-54ed-465e-8b67-54dc15a9ff36"},{"version":"CommandV1","origId":65578720055529,"guid":"eabeaa21-fa45-483c-9fb8-cad03710df68","subtype":"command","commandType":"auto","position":57.0,"command":"df = spark.table('f1_demo.drivers_convert_to_delta')","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"driverId","nullable":true,"type":"integer"},{"metadata":{},"name":"dob","nullable":true,"type":"date"},{"metadata":{},"name":"forename","nullable":true,"type":"string"},{"metadata":{},"name":"surname","nullable":true,"type":"string"},{"metadata":{},"name":"createdDate","nullable":true,"type":"date"},{"metadata":{},"name":"updatedDate","nullable":true,"type":"date"}],"type":"struct"},"tableIdentifier":"dbfs:/mnt/formula1dljavi/demo/drivers_convert_to_delta"}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673210300737,"submitTime":1673210300455,"finishTime":1673210300971,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4a2283cc-22cb-42a3-9805-01133724bb26"},{"version":"CommandV1","origId":65578720055530,"guid":"20ebf332-f45f-42a2-aab7-b0d7f56f2036","subtype":"command","commandType":"auto","position":58.0,"command":"df.write.format('parquet').save('/mnt/formula1dljavi/demo/drivers_convert_to_delta_new')","commandVersion":24,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673210365283,"submitTime":1673210365261,"finishTime":1673210366148,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f7979156-ef80-4923-a61c-70d94ffb1b04"},{"version":"CommandV1","origId":65578720055531,"guid":"a823219a-8c7a-4143-b4fe-9e5d4824fc8a","subtype":"command","commandType":"auto","position":59.0,"command":"%sql\nCONVERT TO DELTA parquet.`/mnt/formula1dljavi/demo/drivers_convert_to_delta_new`","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1673210409658,"submitTime":1673210409635,"finishTime":1673210412801,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2338a451-3bcd-42dc-b4c7-bb76861c2297"},{"version":"CommandV1","origId":65578720055532,"guid":"c3023533-f934-423d-a316-08e7b83fb733","subtype":"command","commandType":"auto","position":60.0,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4aab2279-8572-4d7e-b5a4-885298d85f99"}],"dashboards":[],"guid":"865720d7-289b-4290-acaf-c20293ca5c8b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":65578720055531,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE","environmentMetadata":null}